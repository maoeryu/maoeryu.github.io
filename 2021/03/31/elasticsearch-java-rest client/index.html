<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"maoeryu.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.2.1","exturl":false,"sidebar":{"position":"left","width":200,"display":"post","padding":7,"offset":5},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="elasticsearch版本为7.10,需要java版本为1.8以上.">
<meta property="og:type" content="article">
<meta property="og:title" content="elasticsearch-java-rest client">
<meta property="og:url" content="https://maoeryu.github.io/2021/03/31/elasticsearch-java-rest%20client/index.html">
<meta property="og:site_name" content="FlyingPig">
<meta property="og:description" content="elasticsearch版本为7.10,需要java版本为1.8以上.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-30T16:00:00.000Z">
<meta property="article:modified_time" content="2022-07-26T02:50:51.942Z">
<meta property="article:author" content="maoeryu">
<meta property="article:tag" content="elasticsearch">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://maoeryu.github.io/2021/03/31/elasticsearch-java-rest%20client/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>elasticsearch-java-rest client | FlyingPig</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">FlyingPig</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#low-rest"><span class="nav-number">1.</span> <span class="nav-text">low rest</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#maven"><span class="nav-number">1.1.</span> <span class="nav-text">maven</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#client"><span class="nav-number">1.2.</span> <span class="nav-text">client</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setting"><span class="nav-number">1.3.</span> <span class="nav-text">setting</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E8%AF%B7%E6%B1%82"><span class="nav-number">1.4.</span> <span class="nav-text">执行请求</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5"><span class="nav-number">1.4.1.</span> <span class="nav-text">同步</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5"><span class="nav-number">1.4.2.</span> <span class="nav-text">异步</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="nav-number">1.4.3.</span> <span class="nav-text">请求参数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#high-rest"><span class="nav-number">2.</span> <span class="nav-text">high rest</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#maven-1"><span class="nav-number">2.1.</span> <span class="nav-text">maven</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#client-1"><span class="nav-number">2.2.</span> <span class="nav-text">client</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%A1%A3api"><span class="nav-number">2.3.</span> <span class="nav-text">文档api</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E6%96%87%E6%A1%A3"><span class="nav-number">2.3.1.</span> <span class="nav-text">单文档</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#index"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">index</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#source"><span class="nav-number">2.3.1.1.1.</span> <span class="nav-text">source</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#setting-1"><span class="nav-number">2.3.1.1.2.</span> <span class="nav-text">setting</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82"><span class="nav-number">2.3.1.1.3.</span> <span class="nav-text">请求</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%93%8D%E5%BA%94"><span class="nav-number">2.3.1.1.4.</span> <span class="nav-text">响应</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">get</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#setting-2"><span class="nav-number">2.3.1.2.1.</span> <span class="nav-text">setting</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#exception"><span class="nav-number">2.3.1.2.2.</span> <span class="nav-text">exception</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get-source"><span class="nav-number">2.3.1.3.</span> <span class="nav-text">get source</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#exists"><span class="nav-number">2.3.1.4.</span> <span class="nav-text">exists</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#delete"><span class="nav-number">2.3.1.5.</span> <span class="nav-text">delete</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#update"><span class="nav-number">2.3.1.6.</span> <span class="nav-text">update</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%91%E9%87%8F"><span class="nav-number">2.3.1.7.</span> <span class="nav-text">向量</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E6%96%87%E6%A1%A3"><span class="nav-number">2.3.2.</span> <span class="nav-text">多文档</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#bulk"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">bulk</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#bulk-processor"><span class="nav-number">2.3.2.1.1.</span> <span class="nav-text">bulk processor</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#multi-get"><span class="nav-number">2.3.2.2.</span> <span class="nav-text">multi-get</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#reindex"><span class="nav-number">2.3.2.3.</span> <span class="nav-text">reindex</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#update-by-query"><span class="nav-number">2.3.2.4.</span> <span class="nav-text">update by query</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#delete-by-query"><span class="nav-number">2.3.2.5.</span> <span class="nav-text">delete by query</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rethrottle"><span class="nav-number">2.3.2.6.</span> <span class="nav-text">rethrottle</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#multi-term-vectors"><span class="nav-number">2.3.2.7.</span> <span class="nav-text">multi term vectors</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#search"><span class="nav-number">2.4.</span> <span class="nav-text">search</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#search-api"><span class="nav-number">2.4.1.</span> <span class="nav-text">search api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#search-scroll-api"><span class="nav-number">2.4.2.</span> <span class="nav-text">search scroll api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#clear-scroll-api"><span class="nav-number">2.4.3.</span> <span class="nav-text">clear scroll api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#multi-search-api"><span class="nav-number">2.4.4.</span> <span class="nav-text">multi-search api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#search-template-api"><span class="nav-number">2.4.5.</span> <span class="nav-text">search template api</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E6%A8%A1%E6%9D%BF"><span class="nav-number">2.4.5.1.</span> <span class="nav-text">注册模板</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#multi-search-template-api"><span class="nav-number">2.4.6.</span> <span class="nav-text">multi-search-template api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#field-capabilities-api"><span class="nav-number">2.4.7.</span> <span class="nav-text">field capabilities api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ranking-evaluation-api"><span class="nav-number">2.4.8.</span> <span class="nav-text">ranking evaluation api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#explain-api"><span class="nav-number">2.4.9.</span> <span class="nav-text">explain api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#count-api"><span class="nav-number">2.4.10.</span> <span class="nav-text">count api</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#open-a-point-in-time"><span class="nav-number">2.4.11.</span> <span class="nav-text">open a point in time</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5search"><span class="nav-number">2.5.</span> <span class="nav-text">异步search</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4"><span class="nav-number">2.5.1.</span> <span class="nav-text">提交</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#get-1"><span class="nav-number">2.5.2.</span> <span class="nav-text">get</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#delete-1"><span class="nav-number">2.5.3.</span> <span class="nav-text">delete</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E5%AE%83api"><span class="nav-number">2.6.</span> <span class="nav-text">其它api</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#info-ping"><span class="nav-number">2.6.1.</span> <span class="nav-text">info&#x2F;ping</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#index-api"><span class="nav-number">2.7.</span> <span class="nav-text">index api</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#index-management"><span class="nav-number">2.7.1.</span> <span class="nav-text">index management</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#analyze"><span class="nav-number">2.7.1.1.</span> <span class="nav-text">analyze</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#create"><span class="nav-number">2.7.1.2.</span> <span class="nav-text">create</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#setting-3"><span class="nav-number">2.7.1.2.1.</span> <span class="nav-text">setting</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#mapping"><span class="nav-number">2.7.1.2.2.</span> <span class="nav-text">mapping</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#alias"><span class="nav-number">2.7.1.2.3.</span> <span class="nav-text">alias</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#delete-2"><span class="nav-number">2.7.1.3.</span> <span class="nav-text">delete</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#exists-1"><span class="nav-number">2.7.1.4.</span> <span class="nav-text">exists</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#open-close"><span class="nav-number">2.7.1.5.</span> <span class="nav-text">open&#x2F;close</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#shrink"><span class="nav-number">2.7.1.6.</span> <span class="nav-text">shrink</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#split"><span class="nav-number">2.7.1.7.</span> <span class="nav-text">split</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#clone"><span class="nav-number">2.7.1.8.</span> <span class="nav-text">clone</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#refresh"><span class="nav-number">2.7.1.9.</span> <span class="nav-text">refresh</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#flush"><span class="nav-number">2.7.1.10.</span> <span class="nav-text">flush</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#flush-synced"><span class="nav-number">2.7.1.11.</span> <span class="nav-text">flush synced</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#clear-cache"><span class="nav-number">2.7.1.12.</span> <span class="nav-text">clear cache</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#force-merge"><span class="nav-number">2.7.1.13.</span> <span class="nav-text">force merge</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rollover"><span class="nav-number">2.7.1.14.</span> <span class="nav-text">rollover</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#update-indices-settings"><span class="nav-number">2.7.1.15.</span> <span class="nav-text">update indices settings</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get-settings"><span class="nav-number">2.7.1.16.</span> <span class="nav-text">get settings</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#validate-query"><span class="nav-number">2.7.1.17.</span> <span class="nav-text">validate query</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get-2"><span class="nav-number">2.7.1.18.</span> <span class="nav-text">get</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mapping-management"><span class="nav-number">2.7.2.</span> <span class="nav-text">mapping management</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#update-mapping"><span class="nav-number">2.7.2.1.</span> <span class="nav-text">update mapping</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get-mappings"><span class="nav-number">2.7.2.2.</span> <span class="nav-text">get mappings</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get-field-mappings"><span class="nav-number">2.7.2.3.</span> <span class="nav-text">get field mappings</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#alias-management"><span class="nav-number">2.7.3.</span> <span class="nav-text">alias management</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#index-aliases"><span class="nav-number">2.7.3.1.</span> <span class="nav-text">index aliases</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#exists-alias"><span class="nav-number">2.7.3.2.</span> <span class="nav-text">exists alias</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#get-alias"><span class="nav-number">2.7.3.3.</span> <span class="nav-text">get alias</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#delete-alias"><span class="nav-number">2.7.3.4.</span> <span class="nav-text">delete alias</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#template-management"><span class="nav-number">2.7.4.</span> <span class="nav-text">template management</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#get-templates"><span class="nav-number">2.7.4.1.</span> <span class="nav-text">get templates</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#templates-exist"><span class="nav-number">2.7.4.2.</span> <span class="nav-text">templates exist</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#create-or-update-index-template"><span class="nav-number">2.7.4.3.</span> <span class="nav-text">create or update index template</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">maoeryu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">221</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://maoeryu.github.io/2021/03/31/elasticsearch-java-rest%20client/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="maoeryu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlyingPig">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          elasticsearch-java-rest client
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-03-31 00:00:00" itemprop="dateCreated datePublished" datetime="2021-03-31T00:00:00+08:00">2021-03-31</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-07-26 10:50:51" itemprop="dateModified" datetime="2022-07-26T10:50:51+08:00">2022-07-26</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>elasticsearch版本为7.10,需要java版本为1.8以上.</p>
<span id="more"></span>

<h2 id="low-rest"><a href="#low-rest" class="headerlink" title="low rest"></a>low rest</h2><h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.elasticsearch.client&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;elasticsearch-rest-client&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;7.10.0&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="client"><a href="#client" class="headerlink" title="client"></a>client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RestClientBuilder builder = RestClient.builder(</span><br><span class="line">    <span class="keyword">new</span> HttpHost(<span class="string">&quot;oceanbase004&quot;</span>, <span class="number">9200</span>, <span class="string">&quot;http&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> HttpHost(<span class="string">&quot;oceanbase004&quot;</span>, <span class="number">9211</span>, <span class="string">&quot;http&quot;</span>));</span><br><span class="line"></span><br><span class="line">RestClient client = builder.build();</span><br><span class="line">client.close();</span><br></pre></td></tr></table></figure>

<h3 id="setting"><a href="#setting" class="headerlink" title="setting"></a>setting</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置请求头信息</span></span><br><span class="line">Header[] defaultHeaders = <span class="keyword">new</span> Header[]&#123;<span class="keyword">new</span> BasicHeader(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;value&quot;</span>)&#125;;</span><br><span class="line">builder.setDefaultHeaders(defaultHeaders);</span><br><span class="line"></span><br><span class="line">builder.setNodeSelector(NodeSelector.SKIP_DEDICATED_MASTERS);</span><br></pre></td></tr></table></figure>

<h3 id="执行请求"><a href="#执行请求" class="headerlink" title="执行请求"></a>执行请求</h3><h4 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Request request = <span class="keyword">new</span> Request(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">Response response = client.performRequest(request);</span><br><span class="line">System.out.println(response.getStatusLine().getStatusCode());</span><br></pre></td></tr></table></figure>

<h4 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Request request = <span class="keyword">new</span> Request(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">Cancellable cancellable = client.performRequestAsync(request, <span class="keyword">new</span> ResponseListener() &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(Response response)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置请求参数</span></span><br><span class="line">request.addParameter(<span class="string">&quot;pretty&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line"><span class="comment">// 将请求主体设置为任何httpEntity</span></span><br><span class="line">request.setEntity(<span class="keyword">new</span> NStringEntity(<span class="string">&quot;&#123;\&quot;json\&quot;:\&quot;text\&quot;&#125;&quot;</span>, ContentType.APPLICATION_JSON));</span><br><span class="line">request.setJsonEntity(<span class="string">&quot;&#123;\&quot;json\&quot;:\&quot;text\&quot;&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="high-rest"><a href="#high-rest" class="headerlink" title="high rest"></a>high rest</h2><h3 id="maven-1"><a href="#maven-1" class="headerlink" title="maven"></a>maven</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;elasticsearch-rest-high-level-client&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;7.10.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="client-1"><a href="#client-1" class="headerlink" title="client"></a>client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RestClientBuilder builder = RestClient.builder(</span><br><span class="line">    <span class="keyword">new</span> HttpHost(<span class="string">&quot;oceanbase004&quot;</span>, <span class="number">9200</span>, <span class="string">&quot;http&quot;</span>),</span><br><span class="line">    <span class="keyword">new</span> HttpHost(<span class="string">&quot;oceanbase004&quot;</span>, <span class="number">9211</span>, <span class="string">&quot;http&quot;</span>)</span><br><span class="line">);</span><br><span class="line">client = <span class="keyword">new</span> RestHighLevelClient(builder);</span><br><span class="line"></span><br><span class="line">client.close();</span><br></pre></td></tr></table></figure>

<h3 id="文档api"><a href="#文档api" class="headerlink" title="文档api"></a>文档api</h3><h4 id="单文档"><a href="#单文档" class="headerlink" title="单文档"></a>单文档</h4><h5 id="index"><a href="#index" class="headerlink" title="index"></a>index</h5><h6 id="source"><a href="#source" class="headerlink" title="source"></a>source</h6><p>map source,也可使用json字符串.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; map = Maps.newHashMap();</span><br><span class="line">map.put(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;birth&quot;</span>, <span class="keyword">new</span> Date());</span><br><span class="line">map.put(<span class="string">&quot;age&quot;</span>, <span class="number">11</span>);</span><br><span class="line">map.put(<span class="string">&quot;addr&quot;</span>, <span class="string">&quot;trying out elasticsearch&quot;</span>);</span><br><span class="line">IndexRequest request = <span class="keyword">new</span> IndexRequest(<span class="string">&quot;twitter&quot;</span>).id(<span class="string">&quot;1&quot;</span>).source(map);</span><br></pre></td></tr></table></figure>

<h6 id="setting-1"><a href="#setting-1" class="headerlink" title="setting"></a>setting</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">request.routing(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">request.timeout(<span class="string">&quot;1s&quot;</span>);</span><br><span class="line">request.timeout(TimeValue.timeValueSeconds(<span class="number">1</span>));</span><br><span class="line">request.setRefreshPolicy(WriteRequest.RefreshPolicy.WAIT_UNTIL);</span><br><span class="line">request.setRefreshPolicy(<span class="string">&quot;wait_for&quot;</span>);</span><br><span class="line">request.version(<span class="number">2</span>);</span><br><span class="line">request.versionType(VersionType.EXTERNAL);</span><br><span class="line">request.opType(DocWriteRequest.OpType.CREATE);</span><br><span class="line">request.opType(<span class="string">&quot;create&quot;</span>);</span><br><span class="line">request.setPipeline(<span class="string">&quot;pipeline&quot;</span>);</span><br></pre></td></tr></table></figure>

<h6 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同步请求</span></span><br><span class="line">IndexResponse response = client.index(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="comment">// CREATED</span></span><br><span class="line">System.out.println(response.status());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步请求</span></span><br><span class="line">client.indexAsync(request, RequestOptions.DEFAULT, <span class="keyword">new</span> ActionListener&lt;IndexResponse&gt;() &#123;...&#125;</span><br></pre></td></tr></table></figure>

<h6 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.CREATED) &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;create&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.UPDATED) &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReplicationResponse.ShardInfo shardInfo = response.getShardInfo();</span><br><span class="line"><span class="keyword">if</span> (shardInfo.getTotal() != shardInfo.getSuccessful()) &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (shardInfo.getFailed() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (ReplicationResponse.ShardInfo.Failure failure : shardInfo.getFailures()) &#123;</span><br><span class="line">    System.out.println(failure.reason());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="get"><a href="#get" class="headerlink" title="get"></a>get</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GetRequest request = <span class="keyword">new</span> GetRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">String[] includes = Strings.EMPTY_ARRAY;</span><br><span class="line"><span class="comment">// String[] includes = new String[]&#123;&quot;user&quot;, &quot;*irth&quot;&#125;;</span></span><br><span class="line"><span class="comment">// String[] excludes = Strings.EMPTY_ARRAY;</span></span><br><span class="line"> String[] excludes = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;age&quot;</span>&#125;;</span><br><span class="line">FetchSourceContext fetchSourceContext = <span class="keyword">new</span> FetchSourceContext(<span class="keyword">true</span>, includes, excludes);</span><br><span class="line">request.fetchSourceContext(fetchSourceContext);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  GetResponse response = client.get(request, RequestOptions.DEFAULT);</span><br><span class="line">  <span class="keyword">if</span> (response.isExists()) &#123;</span><br><span class="line">    System.out.println(response.getSourceAsString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (ElasticsearchException e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.status() == RestStatus.NOT_FOUND) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;not found&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="setting-2"><a href="#setting-2" class="headerlink" title="setting"></a>setting</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request.fetchSourceContext(FetchSourceContext.DO_NOT_FETCH_SOURCE);</span><br><span class="line">request.routing(<span class="string">&quot;routing&quot;</span>);</span><br><span class="line">request.preference(<span class="string">&quot;preference&quot;</span>);</span><br><span class="line">request.realtime(<span class="keyword">false</span>);</span><br><span class="line">request.refresh(<span class="keyword">true</span>);</span><br><span class="line">request.version(<span class="number">2</span>);</span><br><span class="line">request.versionType(VersionType.EXTERNAL);</span><br></pre></td></tr></table></figure>

<h6 id="exception"><a href="#exception" class="headerlink" title="exception"></a>exception</h6><p>可查询旧版本.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GetRequest request = <span class="keyword">new</span> GetRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;1&quot;</span>).version(<span class="number">12</span>);</span><br><span class="line"><span class="keyword">if</span> (e.status() == RestStatus.NOT_FOUND) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;not found&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.status() == RestStatus.CONFLICT) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;conflict&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="get-source"><a href="#get-source" class="headerlink" title="get source"></a>get source</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GetSourceRequest request = <span class="keyword">new</span> GetSourceRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">GetSourceResponse response = client.getSource(request, RequestOptions.DEFAULT);</span><br><span class="line">System.out.println(response.getSource());</span><br></pre></td></tr></table></figure>

<p>{birth=2021-11-08T07:37:41.888Z, addr=trying out elasticsearch, user=xx1, age=11}</p>
<h5 id="exists"><a href="#exists" class="headerlink" title="exists"></a>exists</h5><p>关闭source及其它字段,只返回true/false,更高效.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GetRequest request = <span class="keyword">new</span> GetRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="comment">// 禁用获取source字段</span></span><br><span class="line">request.fetchSourceContext(<span class="keyword">new</span> FetchSourceContext(<span class="keyword">false</span>));</span><br><span class="line"><span class="comment">// 禁用获取存储字段</span></span><br><span class="line">request.storedFields(<span class="string">&quot;_none_&quot;</span>);</span><br><span class="line"><span class="keyword">boolean</span> exists = client.exists(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">System.out.println(exists);</span><br></pre></td></tr></table></figure>

<h5 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DeleteRequest request = <span class="keyword">new</span> DeleteRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;2&quot;</span>);</span><br><span class="line">DeleteResponse response = client.delete(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="comment">// NOT_FOUND</span></span><br><span class="line">System.out.println(response.status());</span><br><span class="line"><span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.NOT_FOUND) &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;not found&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="update"><a href="#update" class="headerlink" title="update"></a>update</h5><p>使用doc,当id不存在时,更新会失败.<br>可开启docAsUpsert.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">UpdateRequest request = <span class="keyword">new</span> UpdateRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;11&quot;</span>);</span><br><span class="line"><span class="comment">// request.doc(&quot;name&quot;, &quot;tom1&quot;, &quot;birth&quot;, new Date());</span></span><br><span class="line">request.docAsUpsert(<span class="keyword">true</span>).doc(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;tom1&quot;</span>, <span class="string">&quot;birth&quot;</span>, <span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  UpdateResponse response = client.update(request, RequestOptions.DEFAULT);</span><br><span class="line">  <span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.CREATED) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;create&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.UPDATED) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.DELETED) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;delete&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (response.getResult() == DocWriteResponse.Result.NOOP) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;noop&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (ElasticsearchException e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.status() == RestStatus.NOT_FOUND) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;not fount&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TermVectorsRequest request = <span class="keyword">new</span> TermVectorsRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">request.setFields(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">TermVectorsResponse response = client.termvectors(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h4 id="多文档"><a href="#多文档" class="headerlink" title="多文档"></a>多文档</h4><h5 id="bulk"><a href="#bulk" class="headerlink" title="bulk"></a>bulk</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">BulkRequest request = <span class="keyword">new</span> BulkRequest();</span><br><span class="line"><span class="comment">// BulkRequest request = new BulkRequest(&quot;twitter&quot;);</span></span><br><span class="line">request.add(<span class="keyword">new</span> IndexRequest(<span class="string">&quot;twitter&quot;</span>).id(<span class="string">&quot;1&quot;</span>).source(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>, <span class="string">&quot;birth&quot;</span>, <span class="keyword">new</span> Date()));</span><br><span class="line">request.add(<span class="keyword">new</span> UpdateRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;1&quot;</span>).doc(<span class="string">&quot;birth&quot;</span>, <span class="keyword">new</span> Date()).docAsUpsert(<span class="keyword">true</span>));</span><br><span class="line">request.add(<span class="keyword">new</span> UpdateRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;12&quot;</span>).doc(<span class="string">&quot;birth&quot;</span>, <span class="keyword">new</span> Date()).docAsUpsert(<span class="keyword">true</span>));</span><br><span class="line">request.add(<span class="keyword">new</span> DeleteRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;11&quot;</span>));</span><br><span class="line">BulkResponse response = client.bulk(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">for</span> (BulkItemResponse bulkItemResponse : response) &#123;</span><br><span class="line">  <span class="keyword">if</span> (bulkItemResponse.isFailed()) &#123;</span><br><span class="line">    System.out.println(bulkItemResponse.getFailure().getMessage());</span><br><span class="line">  &#125;</span><br><span class="line">  System.out.println(bulkItemResponse.getOpType());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="bulk-processor"><a href="#bulk-processor" class="headerlink" title="bulk processor"></a>bulk processor</h6><h5 id="multi-get"><a href="#multi-get" class="headerlink" title="multi-get"></a>multi-get</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MultiGetRequest request = <span class="keyword">new</span> MultiGetRequest();</span><br><span class="line">request.add(<span class="keyword">new</span> MultiGetRequest.Item(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;11&quot;</span>));</span><br><span class="line">request.add(<span class="keyword">new</span> MultiGetRequest.Item(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;2&quot;</span>));</span><br><span class="line">request.add(<span class="keyword">new</span> MultiGetRequest.Item(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;12&quot;</span>).fetchSourceContext(FetchSourceContext.DO_NOT_FETCH_SOURCE));</span><br><span class="line">request.add(<span class="keyword">new</span> MultiGetRequest.Item(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;12&quot;</span>));</span><br><span class="line">MultiGetResponse response = client.mget(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">for</span> (MultiGetItemResponse itemResponse : response) &#123;</span><br><span class="line">  <span class="keyword">if</span> (itemResponse.getResponse().isExists()) &#123;</span><br><span class="line">    System.out.println(itemResponse.getResponse().getSourceAsString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>{&quot;user&quot;:&quot;xx1&quot;,&quot;birth&quot;:&quot;2021-11-08T08:57:34.326Z&quot;}<br>null<br>{&quot;birth&quot;:&quot;2021-11-08T08:57:34.452Z&quot;}</p>
<h5 id="reindex"><a href="#reindex" class="headerlink" title="reindex"></a>reindex</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ReindexRequest request = <span class="keyword">new</span> ReindexRequest();</span><br><span class="line">request.setSourceIndices(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.setDestIndex(<span class="string">&quot;my-twitter&quot;</span>);</span><br><span class="line">request.setSourceQuery(<span class="keyword">new</span> TermQueryBuilder(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>));</span><br><span class="line">request.setMaxDocs(<span class="number">1</span>);</span><br><span class="line">request.setSourceBatchSize(<span class="number">100</span>);</span><br><span class="line">request.setScroll(TimeValue.timeValueMinutes(<span class="number">10</span>));</span><br><span class="line">request.setTimeout(TimeValue.timeValueMinutes(<span class="number">2</span>));</span><br><span class="line">request.setRefresh(<span class="keyword">true</span>);</span><br><span class="line">BulkByScrollResponse response = client.reindex(request, RequestOptions.DEFAULT);</span><br><span class="line">TimeValue timeTaken = response.getTook();</span><br><span class="line"><span class="keyword">boolean</span> timedOut = response.isTimedOut();</span><br><span class="line"><span class="keyword">long</span> totalDocs = response.getTotal();</span><br><span class="line"><span class="keyword">long</span> updatedDocs = response.getUpdated();</span><br><span class="line"><span class="keyword">long</span> createdDocs = response.getCreated();</span><br><span class="line"><span class="keyword">long</span> deletedDocs = response.getDeleted();</span><br><span class="line"><span class="keyword">long</span> batches = response.getBatches();</span><br><span class="line"><span class="keyword">long</span> noops = response.getNoops();</span><br><span class="line"><span class="keyword">long</span> versionConflicts = response.getVersionConflicts();</span><br><span class="line"><span class="keyword">long</span> bulkRetries = response.getBulkRetries();</span><br><span class="line"><span class="keyword">long</span> searchRetries = response.getSearchRetries();</span><br></pre></td></tr></table></figure>

<h5 id="update-by-query"><a href="#update-by-query" class="headerlink" title="update by query"></a>update by query</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">UpdateByQueryRequest request = <span class="keyword">new</span> UpdateByQueryRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.setQuery(<span class="keyword">new</span> TermQueryBuilder(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>));</span><br><span class="line">request.setScript(<span class="keyword">new</span> Script(</span><br><span class="line">    ScriptType.INLINE,</span><br><span class="line">    <span class="string">&quot;painless&quot;</span>,</span><br><span class="line">    <span class="string">&quot;if (ctx._source.user == &#x27;xx1&#x27;) &#123;ctx._source.age++;&#125;&quot;</span>,</span><br><span class="line">    Collections.emptyMap()));</span><br><span class="line"></span><br><span class="line">request.setScroll(TimeValue.timeValueMinutes(<span class="number">10</span>));</span><br><span class="line">request.setRefresh(<span class="keyword">true</span>);</span><br><span class="line">BulkByScrollResponse response = client.updateByQuery(request, RequestOptions.DEFAULT);</span><br><span class="line">System.out.println(response);</span><br></pre></td></tr></table></figure>

<h5 id="delete-by-query"><a href="#delete-by-query" class="headerlink" title="delete by query"></a>delete by query</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DeleteByQueryRequest request = <span class="keyword">new</span> DeleteByQueryRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.setQuery(<span class="keyword">new</span> TermQueryBuilder(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>));</span><br><span class="line">request.setMaxDocs(<span class="number">1</span>);</span><br><span class="line">BulkByScrollResponse response = client.deleteByQuery(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h5 id="rethrottle"><a href="#rethrottle" class="headerlink" title="rethrottle"></a>rethrottle</h5><h5 id="multi-term-vectors"><a href="#multi-term-vectors" class="headerlink" title="multi term vectors"></a>multi term vectors</h5><h3 id="search"><a href="#search" class="headerlink" title="search"></a>search</h3><h4 id="search-api"><a href="#search-api" class="headerlink" title="search api"></a>search api</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SearchRequest request = <span class="keyword">new</span> SearchRequest();</span><br><span class="line">SearchSourceBuilder sourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">sourceBuilder.query(QueryBuilders.matchAllQuery());</span><br><span class="line">sourceBuilder.from(<span class="number">0</span>);</span><br><span class="line">sourceBuilder.size(<span class="number">5</span>);</span><br><span class="line">sourceBuilder.sort(<span class="keyword">new</span> FieldSortBuilder(<span class="string">&quot;age&quot;</span>).order(SortOrder.ASC));</span><br><span class="line">request.source(sourceBuilder).indices(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">SearchResponse response = client.search(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">for</span> (SearchHit hit : response.getHits()) &#123;</span><br><span class="line">  System.out.println(hit.getSourceAsString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="search-scroll-api"><a href="#search-scroll-api" class="headerlink" title="search scroll api"></a>search scroll api</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Scroll scroll = <span class="keyword">new</span> Scroll(TimeValue.timeValueMinutes(<span class="number">1L</span>));</span><br><span class="line">SearchRequest request = <span class="keyword">new</span> SearchRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.scroll(scroll);</span><br><span class="line">SearchSourceBuilder sourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">sourceBuilder.query(QueryBuilders.termQuery(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>));</span><br><span class="line">request.source(sourceBuilder);</span><br><span class="line"></span><br><span class="line">SearchResponse response = client.search(request, RequestOptions.DEFAULT);</span><br><span class="line">String scrollId = response.getScrollId();</span><br><span class="line">SearchHit[] searchHits = response.getHits().getHits();</span><br><span class="line"><span class="keyword">for</span> (SearchHit hit : searchHits) &#123;</span><br><span class="line">  System.out.println(hit.getSourceAsString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (searchHits != <span class="keyword">null</span> &amp;&amp; searchHits.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  SearchScrollRequest scrollRequest = <span class="keyword">new</span> SearchScrollRequest(scrollId);</span><br><span class="line">  scrollRequest.scroll(scroll);</span><br><span class="line">  response = client.scroll(scrollRequest, RequestOptions.DEFAULT);</span><br><span class="line">  scrollId = response.getScrollId();</span><br><span class="line">  searchHits = response.getHits().getHits();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ClearScrollRequest clearScrollRequest = <span class="keyword">new</span> ClearScrollRequest();</span><br><span class="line">clearScrollRequest.addScrollId(scrollId);</span><br><span class="line">ClearScrollResponse clearScrollResponse = client.clearScroll(clearScrollRequest, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">boolean</span> succeeded = clearScrollResponse.isSucceeded();</span><br><span class="line">System.out.println(succeeded);</span><br></pre></td></tr></table></figure>

<h4 id="clear-scroll-api"><a href="#clear-scroll-api" class="headerlink" title="clear scroll api"></a>clear scroll api</h4><h4 id="multi-search-api"><a href="#multi-search-api" class="headerlink" title="multi-search api"></a>multi-search api</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MultiSearchRequest request = <span class="keyword">new</span> MultiSearchRequest();</span><br><span class="line">SearchRequest request1 = <span class="keyword">new</span> SearchRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">SearchSourceBuilder sourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">sourceBuilder.query(QueryBuilders.termQuery(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;xx2&quot;</span>));</span><br><span class="line">request1.source(sourceBuilder);</span><br><span class="line">request.add(request1);</span><br><span class="line"></span><br><span class="line">SearchRequest request2 = <span class="keyword">new</span> SearchRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">sourceBuilder = <span class="keyword">new</span> SearchSourceBuilder();</span><br><span class="line">sourceBuilder.query(QueryBuilders.termQuery(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>));</span><br><span class="line">request2.source(sourceBuilder);</span><br><span class="line">request.add(request2);</span><br><span class="line">MultiSearchResponse response = client.msearch(request, RequestOptions.DEFAULT);</span><br><span class="line">MultiSearchResponse.Item[] responses = response.getResponses();</span><br><span class="line"><span class="keyword">for</span> (MultiSearchResponse.Item item : responses) &#123;</span><br><span class="line">  <span class="keyword">for</span> (SearchHit hit : item.getResponse().getHits()) &#123;</span><br><span class="line">    System.out.println(hit.getSourceAsString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="search-template-api"><a href="#search-template-api" class="headerlink" title="search template api"></a>search template api</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">SearchTemplateRequest request = <span class="keyword">new</span> SearchTemplateRequest();</span><br><span class="line">request.setRequest(<span class="keyword">new</span> SearchRequest(<span class="string">&quot;twitter&quot;</span>));</span><br><span class="line">request.setScriptType(ScriptType.INLINE);</span><br><span class="line">request.setScript(<span class="string">&quot;&#123;\&quot;query\&quot;:&#123;\&quot;match\&quot;:&#123;\&quot;&#123;&#123;field&#125;&#125;\&quot;:\&quot;&#123;&#123;value&#125;&#125;\&quot;&#125;&#125;,\&quot;size\&quot;:\&quot;&#123;&#123;size&#125;&#125;\&quot;&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">Map&lt;String, Object&gt; scriptParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">scriptParams.put(<span class="string">&quot;field&quot;</span>, <span class="string">&quot;user&quot;</span>);</span><br><span class="line">scriptParams.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;xx1&quot;</span>);</span><br><span class="line">scriptParams.put(<span class="string">&quot;size&quot;</span>, <span class="number">5</span>);</span><br><span class="line">request.setScriptParams(scriptParams);</span><br><span class="line">SearchTemplateResponse response = client.searchTemplate(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">if</span> (response.hasResponse()) &#123;</span><br><span class="line">  <span class="keyword">for</span> (SearchHit hit : response.getResponse().getHits()) &#123;</span><br><span class="line">    System.out.println(hit.getSourceAsString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h5 id="注册模板"><a href="#注册模板" class="headerlink" title="注册模板"></a>注册模板</h5><p>注册模板需要使用restClient.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注册脚本</span></span><br><span class="line">Request request = <span class="keyword">new</span> Request(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;_scripts/xx&quot;</span>);</span><br><span class="line">request.setJsonEntity(<span class="string">&quot;&#123;\&quot;script\&quot;:&#123;\&quot;lang\&quot;:\&quot;mustache\&quot;,\&quot;source\&quot;:&#123;\&quot;query\&quot;:&#123;\&quot;match\&quot;:&#123;\&quot;&#123;&#123;field&#125;&#125;\&quot;:\&quot;&#123;&#123;value&#125;&#125;\&quot;&#125;&#125;,\&quot;size\&quot;:\&quot;&#123;&#123;size&#125;&#125;\&quot;&#125;&#125;&#125;&quot;</span>);</span><br><span class="line">Response response = restClient.performRequest(request);</span><br><span class="line">System.out.println(response.getStatusLine().getStatusCode());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用存储脚本</span></span><br><span class="line">SearchTemplateRequest templateRequest = <span class="keyword">new</span> SearchTemplateRequest();</span><br><span class="line">templateRequest.setRequest(<span class="keyword">new</span> SearchRequest(<span class="string">&quot;twitter&quot;</span>));</span><br><span class="line">templateRequest.setScriptType(ScriptType.STORED);</span><br><span class="line">templateRequest.setScript(<span class="string">&quot;xx&quot;</span>);</span><br><span class="line"></span><br><span class="line">Map&lt;String, Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">params.put(<span class="string">&quot;field&quot;</span>, <span class="string">&quot;user&quot;</span>);</span><br><span class="line">params.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;xx1&quot;</span>);</span><br><span class="line">params.put(<span class="string">&quot;size&quot;</span>, <span class="number">5</span>);</span><br><span class="line">templateRequest.setScriptParams(params);</span><br><span class="line">SearchTemplateResponse templateResponse = client.searchTemplate(templateRequest, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">if</span> (templateResponse.hasResponse()) &#123;</span><br><span class="line">  <span class="keyword">for</span> (SearchHit hit : templateResponse.getResponse().getHits()) &#123;</span><br><span class="line">    System.out.println(hit.getSourceAsString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="multi-search-template-api"><a href="#multi-search-template-api" class="headerlink" title="multi-search-template api"></a>multi-search-template api</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">String[] searchTerms = &#123;<span class="string">&quot;xx1&quot;</span>, <span class="string">&quot;tom1&quot;</span>&#125;;</span><br><span class="line">MultiSearchTemplateRequest multiRequest = <span class="keyword">new</span> MultiSearchTemplateRequest();</span><br><span class="line"><span class="keyword">for</span> (String searchTerm : searchTerms) &#123;</span><br><span class="line">  SearchTemplateRequest request = <span class="keyword">new</span> SearchTemplateRequest();</span><br><span class="line">  request.setRequest(<span class="keyword">new</span> SearchRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;my-twitter&quot;</span>));</span><br><span class="line">  request.setScriptType(ScriptType.INLINE);</span><br><span class="line">  request.setScript(<span class="string">&quot;&#123;\&quot;query\&quot;:&#123;\&quot;match\&quot;:&#123;\&quot;&#123;&#123;field&#125;&#125;\&quot;:\&quot;&#123;&#123;value&#125;&#125;\&quot;&#125;&#125;,\&quot;size\&quot;:\&quot;&#123;&#123;size&#125;&#125;\&quot;&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  Map&lt;String, Object&gt; scriptParams = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  scriptParams.put(<span class="string">&quot;field&quot;</span>, <span class="string">&quot;user&quot;</span>);</span><br><span class="line">  scriptParams.put(<span class="string">&quot;value&quot;</span>, searchTerm);</span><br><span class="line">  scriptParams.put(<span class="string">&quot;size&quot;</span>, <span class="number">5</span>);</span><br><span class="line">  request.setScriptParams(scriptParams);</span><br><span class="line">  multiRequest.add(request);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MultiSearchTemplateResponse multiResponse = client.msearchTemplate(multiRequest, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">for</span> (MultiSearchTemplateResponse.Item item : multiResponse.getResponses()) &#123;</span><br><span class="line">  <span class="keyword">if</span> (item.isFailure()) &#123;</span><br><span class="line">    System.out.println(item.getFailureMessage());</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    SearchTemplateResponse searchTemplateResponse = item.getResponse();</span><br><span class="line">    SearchResponse searchResponse = searchTemplateResponse.getResponse();</span><br><span class="line">    <span class="keyword">for</span> (SearchHit hit : searchResponse.getHits()) &#123;</span><br><span class="line">      System.out.println(hit.getSourceAsString());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="field-capabilities-api"><a href="#field-capabilities-api" class="headerlink" title="field capabilities api"></a>field capabilities api</h4><p>提供跨多个索引检索字段的功能.<br>keyword/text.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">FieldCapabilitiesRequest request = <span class="keyword">new</span> FieldCapabilitiesRequest()</span><br><span class="line">    .fields(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    .indices(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;my-twitter&quot;</span>);</span><br><span class="line"></span><br><span class="line">FieldCapabilitiesResponse response = client.fieldCaps(request, RequestOptions.DEFAULT);</span><br><span class="line">Map&lt;String, FieldCapabilities&gt; userResponse = response.getField(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">FieldCapabilities textCapabilities = userResponse.get(<span class="string">&quot;text&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">boolean</span> isSearchable = textCapabilities.isSearchable();</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">System.out.println(isSearchable);</span><br><span class="line"><span class="comment">// false</span></span><br><span class="line"><span class="keyword">boolean</span> isAggregatable = textCapabilities.isAggregatable();</span><br><span class="line">System.out.println(isAggregatable);</span><br></pre></td></tr></table></figure>

<h4 id="ranking-evaluation-api"><a href="#ranking-evaluation-api" class="headerlink" title="ranking evaluation api"></a>ranking evaluation api</h4><h4 id="explain-api"><a href="#explain-api" class="headerlink" title="explain api"></a>explain api</h4><h4 id="count-api"><a href="#count-api" class="headerlink" title="count api"></a>count api</h4><h4 id="open-a-point-in-time"><a href="#open-a-point-in-time" class="headerlink" title="open a point in time"></a>open a point in time</h4><h3 id="异步search"><a href="#异步search" class="headerlink" title="异步search"></a>异步search</h3><p>向群集提交异步搜索任务.</p>
<h4 id="提交"><a href="#提交" class="headerlink" title="提交"></a>提交</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SearchSourceBuilder searchSource = <span class="keyword">new</span> SearchSourceBuilder().query(QueryBuilders.matchAllQuery());</span><br><span class="line">String[] indices = <span class="keyword">new</span> String[]&#123;<span class="string">&quot;twitter&quot;</span>&#125;;</span><br><span class="line">SubmitAsyncSearchRequest request = <span class="keyword">new</span> SubmitAsyncSearchRequest(searchSource, indices);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置参数</span></span><br><span class="line">request.setWaitForCompletionTimeout(TimeValue.timeValueSeconds(<span class="number">30</span>));</span><br><span class="line">request.setKeepAlive(TimeValue.timeValueMinutes(<span class="number">15</span>));</span><br><span class="line">request.setKeepOnCompletion(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提交</span></span><br><span class="line">AsyncSearchResponse response = client.asyncSearch().submit(request, RequestOptions.DEFAULT);</span><br><span class="line">SearchResponse searchResponse = response.getSearchResponse();</span><br><span class="line">System.out.println(searchResponse);</span><br></pre></td></tr></table></figure>

<h4 id="get-1"><a href="#get-1" class="headerlink" title="get"></a>get</h4><p>按id获取正在运行的异步搜索任务.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GetAsyncSearchRequest request = <span class="keyword">new</span> GetAsyncSearchRequest(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">request.setWaitForCompletion(TimeValue.timeValueSeconds(<span class="number">30</span>));</span><br><span class="line">request.setKeepAlive(TimeValue.timeValueMinutes(<span class="number">15</span>));</span><br><span class="line">AsyncSearchResponse response = client.asyncSearch().get(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h4 id="delete-1"><a href="#delete-1" class="headerlink" title="delete"></a>delete</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DeleteAsyncSearchRequest request = <span class="keyword">new</span> DeleteAsyncSearchRequest(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">AcknowledgedResponse response = client.asyncSearch().delete(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h3 id="其它api"><a href="#其它api" class="headerlink" title="其它api"></a>其它api</h3><h4 id="info-ping"><a href="#info-ping" class="headerlink" title="info/ping"></a>info/ping</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MainResponse response = client.info(RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">boolean</span> response2 = client.ping(RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h3 id="index-api"><a href="#index-api" class="headerlink" title="index api"></a>index api</h3><h4 id="index-management"><a href="#index-management" class="headerlink" title="index management"></a>index management</h4><h5 id="analyze"><a href="#analyze" class="headerlink" title="analyze"></a>analyze</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AnalyzeRequest request = AnalyzeRequest.withGlobalAnalyzer(<span class="string">&quot;english&quot;</span>, <span class="string">&quot;xx1&quot;</span>);</span><br><span class="line">AnalyzeResponse response = client.indices().analyze(request, RequestOptions.DEFAULT);</span><br><span class="line">DetailAnalyzeResponse detail = response.detail();</span><br><span class="line">System.out.println(detail.toString());</span><br></pre></td></tr></table></figure>

<h5 id="create"><a href="#create" class="headerlink" title="create"></a>create</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;settings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;number_of_shards&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">&quot;number_of_replicas&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;mappings&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;message&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;text&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;aliases&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;twitter_alias&quot;</span>: &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CreateIndexRequest request = <span class="keyword">new</span> CreateIndexRequest(<span class="string">&quot;twitter4&quot;</span>);</span><br><span class="line">request.source(<span class="string">&quot;&#123;\&quot;settings\&quot;:&#123;\&quot;number_of_shards\&quot;:1,\&quot;number_of_replicas\&quot;:0&#125;,\&quot;mappings\&quot;:&#123;\&quot;properties\&quot;:&#123;\&quot;message\&quot;:&#123;\&quot;type\&quot;:\&quot;text\&quot;&#125;&#125;&#125;,\&quot;aliases\&quot;:&#123;\&quot;twitter4_alias\&quot;:&#123;&#125;&#125;&#125;&quot;</span>, XContentType.JSON);</span><br><span class="line"></span><br><span class="line">request.setTimeout(TimeValue.timeValueMinutes(<span class="number">2</span>));</span><br><span class="line">request.setMasterTimeout(TimeValue.timeValueMinutes(<span class="number">1</span>));</span><br><span class="line">request.waitForActiveShards(ActiveShardCount.from(<span class="number">2</span>));</span><br><span class="line">request.waitForActiveShards(ActiveShardCount.DEFAULT);</span><br><span class="line"></span><br><span class="line">CreateIndexResponse response = client.indices().create(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">boolean</span> acknowledged = response.isAcknowledged();</span><br><span class="line"><span class="keyword">boolean</span> shardsAcknowledged = response.isShardsAcknowledged();</span><br></pre></td></tr></table></figure>

<h6 id="setting-3"><a href="#setting-3" class="headerlink" title="setting"></a>setting</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">request.settings(Settings.builder()</span><br><span class="line">    .put(<span class="string">&quot;index.number_of_shards&quot;</span>, <span class="number">3</span>)</span><br><span class="line">    .put(<span class="string">&quot;index.number_of_replicas&quot;</span>, <span class="number">0</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h6 id="mapping"><a href="#mapping" class="headerlink" title="mapping"></a>mapping</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">request.mapping(<span class="string">&quot;&#123;\&quot;properties\&quot;:&#123;\&quot;message\&quot;:&#123;\&quot;type\&quot;:\&quot;text\&quot;&#125;&#125;&#125;&quot;</span>, XContentType.JSON);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或使用map封装</span></span><br><span class="line">Map&lt;String, Object&gt; message = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">message.put(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;text&quot;</span>);</span><br><span class="line">Map&lt;String, Object&gt; properties = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">properties.put(<span class="string">&quot;message&quot;</span>, message);</span><br><span class="line">Map&lt;String, Object&gt; mapping = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">mapping.put(<span class="string">&quot;properties&quot;</span>, properties);</span><br><span class="line">request.mapping(mapping);</span><br></pre></td></tr></table></figure>

<h6 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.alias(<span class="keyword">new</span> Alias(<span class="string">&quot;twitter2_alias&quot;</span>).filter(QueryBuilders.termQuery(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;xx1&quot;</span>)));</span><br></pre></td></tr></table></figure>

<h5 id="delete-2"><a href="#delete-2" class="headerlink" title="delete"></a>delete</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DeleteIndexRequest request = <span class="keyword">new</span> DeleteIndexRequest(<span class="string">&quot;twitter3&quot;</span>);</span><br><span class="line"></span><br><span class="line">request.timeout(TimeValue.timeValueMinutes(<span class="number">2</span>));</span><br><span class="line">request.timeout(<span class="string">&quot;2m&quot;</span>);</span><br><span class="line"></span><br><span class="line">org.elasticsearch.action.support.master.AcknowledgedResponse response = client.indices().delete(request, RequestOptions.DEFAULT);</span><br><span class="line"><span class="keyword">boolean</span> acknowledged = response.isAcknowledged();</span><br><span class="line">System.out.println(acknowledged);</span><br></pre></td></tr></table></figure>

<h5 id="exists-1"><a href="#exists-1" class="headerlink" title="exists"></a>exists</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GetIndexRequest request = <span class="keyword">new</span> GetIndexRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.local(<span class="keyword">false</span>);</span><br><span class="line">request.humanReadable(<span class="keyword">true</span>);</span><br><span class="line">request.includeDefaults(<span class="keyword">false</span>);</span><br><span class="line"><span class="keyword">boolean</span> exists = client.indices().exists(request, RequestOptions.DEFAULT);</span><br><span class="line">System.out.println(exists);</span><br></pre></td></tr></table></figure>

<h5 id="open-close"><a href="#open-close" class="headerlink" title="open/close"></a>open/close</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OpenIndexRequest request = <span class="keyword">new</span> OpenIndexRequest(<span class="string">&quot;twitter2&quot;</span>);</span><br><span class="line">OpenIndexResponse response = client.indices().open(request, RequestOptions.DEFAULT);</span><br><span class="line"></span><br><span class="line">CloseIndexRequest request = <span class="keyword">new</span> CloseIndexRequest(<span class="string">&quot;twitter2&quot;</span>);</span><br><span class="line">CloseIndexResponse response = client.indices().close(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h5 id="shrink"><a href="#shrink" class="headerlink" title="shrink"></a>shrink</h5><h5 id="split"><a href="#split" class="headerlink" title="split"></a>split</h5><h5 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h5><h5 id="refresh"><a href="#refresh" class="headerlink" title="refresh"></a>refresh</h5><h5 id="flush"><a href="#flush" class="headerlink" title="flush"></a>flush</h5><h5 id="flush-synced"><a href="#flush-synced" class="headerlink" title="flush synced"></a>flush synced</h5><h5 id="clear-cache"><a href="#clear-cache" class="headerlink" title="clear cache"></a>clear cache</h5><h5 id="force-merge"><a href="#force-merge" class="headerlink" title="force merge"></a>force merge</h5><h5 id="rollover"><a href="#rollover" class="headerlink" title="rollover"></a>rollover</h5><h5 id="update-indices-settings"><a href="#update-indices-settings" class="headerlink" title="update indices settings"></a>update indices settings</h5><h5 id="get-settings"><a href="#get-settings" class="headerlink" title="get settings"></a>get settings</h5><h5 id="validate-query"><a href="#validate-query" class="headerlink" title="validate query"></a>validate query</h5><h5 id="get-2"><a href="#get-2" class="headerlink" title="get"></a>get</h5><h4 id="mapping-management"><a href="#mapping-management" class="headerlink" title="mapping management"></a>mapping management</h4><h5 id="update-mapping"><a href="#update-mapping" class="headerlink" title="update mapping"></a>update mapping</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PutMappingRequest request = <span class="keyword">new</span> PutMappingRequest(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.source(<span class="string">&quot;&#123;\&quot;properties\&quot;:&#123;\&quot;message\&quot;:&#123;\&quot;type\&quot;:\&quot;text\&quot;&#125;&#125;&#125;&quot;</span>, XContentType.JSON);</span><br><span class="line">org.elasticsearch.action.support.master.AcknowledgedResponse response = client.indices().putMapping(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h5 id="get-mappings"><a href="#get-mappings" class="headerlink" title="get mappings"></a>get mappings</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GetMappingsRequest request = <span class="keyword">new</span> GetMappingsRequest();</span><br><span class="line">request.indices(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">GetMappingsResponse response = client.indices().getMapping(request, RequestOptions.DEFAULT);</span><br><span class="line">Map&lt;String, MappingMetadata&gt; mappings = response.mappings();</span><br><span class="line"><span class="keyword">for</span> (String key : mappings.keySet()) &#123;</span><br><span class="line">  System.out.println(mappings.get(key).getSourceAsMap());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="get-field-mappings"><a href="#get-field-mappings" class="headerlink" title="get field mappings"></a>get field mappings</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GetFieldMappingsRequest request = <span class="keyword">new</span> GetFieldMappingsRequest();</span><br><span class="line">request.indices(<span class="string">&quot;twitter&quot;</span>);</span><br><span class="line">request.fields(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;user&quot;</span>);</span><br><span class="line">GetFieldMappingsResponse response = client.indices().getFieldMapping(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h4 id="alias-management"><a href="#alias-management" class="headerlink" title="alias management"></a>alias management</h4><h5 id="index-aliases"><a href="#index-aliases" class="headerlink" title="index aliases"></a>index aliases</h5><p>add/remove索引别名.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">IndicesAliasesRequest request = <span class="keyword">new</span> IndicesAliasesRequest();</span><br><span class="line">IndicesAliasesRequest.AliasActions aliasAction =</span><br><span class="line">    <span class="keyword">new</span> IndicesAliasesRequest.AliasActions(IndicesAliasesRequest.AliasActions.Type.ADD)</span><br><span class="line">        .index(<span class="string">&quot;twitter&quot;</span>)</span><br><span class="line">        .alias(<span class="string">&quot;alias1&quot;</span>);</span><br><span class="line">request.addAliasAction(aliasAction);</span><br><span class="line"></span><br><span class="line">IndicesAliasesRequest.AliasActions addIndicesAction =</span><br><span class="line">    <span class="keyword">new</span> IndicesAliasesRequest.AliasActions(IndicesAliasesRequest.AliasActions.Type.ADD)</span><br><span class="line">        .indices(<span class="string">&quot;twitter&quot;</span>)</span><br><span class="line">        .alias(<span class="string">&quot;alias2&quot;</span>)</span><br><span class="line">        .routing(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">request.addAliasAction(addIndicesAction);</span><br><span class="line"></span><br><span class="line">IndicesAliasesRequest.AliasActions removeAction =</span><br><span class="line">    <span class="keyword">new</span> IndicesAliasesRequest.AliasActions(IndicesAliasesRequest.AliasActions.Type.REMOVE)</span><br><span class="line">        .index(<span class="string">&quot;twitter&quot;</span>)</span><br><span class="line">        .alias(<span class="string">&quot;alias1&quot;</span>);</span><br><span class="line">request.addAliasAction(removeAction);</span><br><span class="line"></span><br><span class="line">org.elasticsearch.action.support.master.AcknowledgedResponse response = client.indices().updateAliases(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h5 id="exists-alias"><a href="#exists-alias" class="headerlink" title="exists alias"></a>exists alias</h5><h5 id="get-alias"><a href="#get-alias" class="headerlink" title="get alias"></a>get alias</h5><h5 id="delete-alias"><a href="#delete-alias" class="headerlink" title="delete alias"></a>delete alias</h5><p>同remove.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DeleteAliasRequest request = <span class="keyword">new</span> DeleteAliasRequest(<span class="string">&quot;twitter&quot;</span>, <span class="string">&quot;alias2&quot;</span>);</span><br><span class="line">AcknowledgedResponse response = client.indices().deleteAlias(request, RequestOptions.DEFAULT);</span><br></pre></td></tr></table></figure>

<h4 id="template-management"><a href="#template-management" class="headerlink" title="template management"></a>template management</h4><h5 id="get-templates"><a href="#get-templates" class="headerlink" title="get templates"></a>get templates</h5><h5 id="templates-exist"><a href="#templates-exist" class="headerlink" title="templates exist"></a>templates exist</h5><h5 id="create-or-update-index-template"><a href="#create-or-update-index-template" class="headerlink" title="create or update index template"></a>create or update index template</h5>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/elasticsearch/" rel="tag"># elasticsearch</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/03/16/dingtalk%E6%8A%A5%E8%AD%A6%E7%9B%91%E6%8E%A7/" rel="prev" title="dingtalk报警监控">
                  <i class="fa fa-chevron-left"></i> dingtalk报警监控
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/09/07/java%E7%BA%BF%E7%A8%8B%E6%B1%A0/" rel="next" title="java线程池">
                  java线程池 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">maoeryu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  





</body>
</html>
