<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"maoeryu.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.2.1","exturl":false,"sidebar":{"position":"left","width":200,"display":"post","padding":7,"offset":5},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="本页面描述了 Flink 所支持的 SQL 语言,包括数据定义语言(Data Definition Language,DDL)&#x2F;数据操纵语言(Data Manipulation Language,DML)以及查询语言.Flink 对 SQL 的支持基于实现了 SQL 标准的 Apache Calcite. 本页面列出了目前 Flink SQL 所支持的所有语句:SELECT (Queries)CR">
<meta property="og:type" content="article">
<meta property="og:title" content="flink sql ddl&amp;dml">
<meta property="og:url" content="https://maoeryu.github.io/2022/08/22/flink%20sql%20ddl&dml/index.html">
<meta property="og:site_name" content="FlyingPig">
<meta property="og:description" content="本页面描述了 Flink 所支持的 SQL 语言,包括数据定义语言(Data Definition Language,DDL)&#x2F;数据操纵语言(Data Manipulation Language,DML)以及查询语言.Flink 对 SQL 的支持基于实现了 SQL 标准的 Apache Calcite. 本页面列出了目前 Flink SQL 所支持的所有语句:SELECT (Queries)CR">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-08-21T16:00:00.000Z">
<meta property="article:modified_time" content="2022-12-02T06:10:33.561Z">
<meta property="article:author" content="maoeryu">
<meta property="article:tag" content="flink">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://maoeryu.github.io/2022/08/22/flink%20sql%20ddl&dml/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>flink sql ddl&dml | FlyingPig</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">FlyingPig</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A5%E9%97%A8"><span class="nav-number">1.</span> <span class="nav-text">入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-number">1.1.</span> <span class="nav-text">SQL 客户端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hello-World"><span class="nav-number">1.2.</span> <span class="nav-text">Hello World</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Source-%E8%A1%A8"><span class="nav-number">1.3.</span> <span class="nav-text">Source 表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E7%BB%AD%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.4.</span> <span class="nav-text">连续查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sink-%E8%A1%A8"><span class="nav-number">1.5.</span> <span class="nav-text">Sink 表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.</span> <span class="nav-text">CREATE 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-CREATE-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.1.</span> <span class="nav-text">执行 CREATE 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java"><span class="nav-number">2.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql"><span class="nav-number">2.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE-TABLE"><span class="nav-number">2.2.</span> <span class="nav-text">CREATE TABLE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Columns-%E5%88%97"><span class="nav-number">2.2.1.</span> <span class="nav-text">Columns(列)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Physical-Regular-Columns-%E7%89%A9%E7%90%86-%E5%B8%B8%E8%A7%84%E5%88%97"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">Physical &#x2F; Regular Columns(物理&#x2F;常规列)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Metadata-Columns-%E5%85%83%E6%95%B0%E6%8D%AE%E5%88%97"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">Metadata Columns(元数据列)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Computed-Columns-%E8%AE%A1%E7%AE%97%E5%88%97"><span class="nav-number">2.2.1.3.</span> <span class="nav-text">Computed Columns(计算列)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WATERMARK"><span class="nav-number">2.2.2.</span> <span class="nav-text">WATERMARK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PRIMARY-KEY"><span class="nav-number">2.2.3.</span> <span class="nav-text">PRIMARY KEY</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%89%E6%95%88%E6%80%A7%E6%A3%80%E6%9F%A5"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">有效性检查</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PARTITIONED-BY"><span class="nav-number">2.2.4.</span> <span class="nav-text">PARTITIONED BY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WITH-Options"><span class="nav-number">2.2.5.</span> <span class="nav-text">WITH Options</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LIKE"><span class="nav-number">2.2.6.</span> <span class="nav-text">LIKE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE-CATALOG"><span class="nav-number">2.3.</span> <span class="nav-text">CREATE CATALOG</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#WITH-OPTIONS"><span class="nav-number">2.3.1.</span> <span class="nav-text">WITH OPTIONS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE-DATABASE"><span class="nav-number">2.4.</span> <span class="nav-text">CREATE DATABASE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-NOT-EXISTS"><span class="nav-number">2.4.1.</span> <span class="nav-text">IF NOT EXISTS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WITH-OPTIONS-1"><span class="nav-number">2.4.2.</span> <span class="nav-text">WITH OPTIONS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE-VIEW"><span class="nav-number">2.5.</span> <span class="nav-text">CREATE VIEW</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY"><span class="nav-number">2.5.1.</span> <span class="nav-text">TEMPORARY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-NOT-EXISTS-1"><span class="nav-number">2.5.2.</span> <span class="nav-text">IF NOT EXISTS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE-FUNCTION"><span class="nav-number">2.6.</span> <span class="nav-text">CREATE FUNCTION</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-1"><span class="nav-number">2.6.1.</span> <span class="nav-text">TEMPORARY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-SYSTEM"><span class="nav-number">2.6.2.</span> <span class="nav-text">TEMPORARY SYSTEM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-NOT-EXISTS-2"><span class="nav-number">2.6.3.</span> <span class="nav-text">IF NOT EXISTS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LANGUAGE-JAVA-SCALA-PYTHON"><span class="nav-number">2.6.4.</span> <span class="nav-text">LANGUAGE JAVA|SCALA|PYTHON</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DROP-%E8%AF%AD%E5%8F%A5"><span class="nav-number">3.</span> <span class="nav-text">DROP 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-DROP-%E8%AF%AD%E5%8F%A5"><span class="nav-number">3.1.</span> <span class="nav-text">执行 DROP 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-1"><span class="nav-number">3.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-1"><span class="nav-number">3.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DROP-CATALOG"><span class="nav-number">3.2.</span> <span class="nav-text">DROP CATALOG</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-EXISTS"><span class="nav-number">3.2.1.</span> <span class="nav-text">IF EXISTS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DROP-TABLE"><span class="nav-number">3.3.</span> <span class="nav-text">DROP TABLE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-EXISTS-1"><span class="nav-number">3.3.1.</span> <span class="nav-text">IF EXISTS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DROP-DATABASE"><span class="nav-number">3.4.</span> <span class="nav-text">DROP DATABASE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-EXISTS-2"><span class="nav-number">3.4.1.</span> <span class="nav-text">IF EXISTS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RESTRICT"><span class="nav-number">3.4.2.</span> <span class="nav-text">RESTRICT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CASCADE"><span class="nav-number">3.4.3.</span> <span class="nav-text">CASCADE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DROP-VIEW"><span class="nav-number">3.5.</span> <span class="nav-text">DROP VIEW</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-2"><span class="nav-number">3.5.1.</span> <span class="nav-text">TEMPORARY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-EXISTS-3"><span class="nav-number">3.5.2.</span> <span class="nav-text">IF EXISTS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DROP-FUNCTION"><span class="nav-number">3.6.</span> <span class="nav-text">DROP FUNCTION</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-3"><span class="nav-number">3.6.1.</span> <span class="nav-text">TEMPORARY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-SYSTEM-1"><span class="nav-number">3.6.2.</span> <span class="nav-text">TEMPORARY SYSTEM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-EXISTS-4"><span class="nav-number">3.6.3.</span> <span class="nav-text">IF EXISTS</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ALTER-%E8%AF%AD%E5%8F%A5"><span class="nav-number">4.</span> <span class="nav-text">ALTER 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-ALTER-%E8%AF%AD%E5%8F%A5"><span class="nav-number">4.1.</span> <span class="nav-text">执行 ALTER 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-2"><span class="nav-number">4.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-2"><span class="nav-number">4.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ALTER-TABLE"><span class="nav-number">4.2.</span> <span class="nav-text">ALTER TABLE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="nav-number">4.2.1.</span> <span class="nav-text">重命名表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E6%88%96%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%B1%9E%E6%80%A7"><span class="nav-number">4.2.2.</span> <span class="nav-text">设置或修改表属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ALTER-VIEW"><span class="nav-number">4.3.</span> <span class="nav-text">ALTER VIEW</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ALTER-DATABASE"><span class="nav-number">4.4.</span> <span class="nav-text">ALTER DATABASE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ALTER-FUNCTION"><span class="nav-number">4.5.</span> <span class="nav-text">ALTER FUNCTION</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-4"><span class="nav-number">4.5.1.</span> <span class="nav-text">TEMPORARY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TEMPORARY-SYSTEM-2"><span class="nav-number">4.5.2.</span> <span class="nav-text">TEMPORARY SYSTEM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IF-EXISTS-5"><span class="nav-number">4.5.3.</span> <span class="nav-text">IF EXISTS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LANGUAGE-JAVA-SCALA-PYTHON-1"><span class="nav-number">4.5.4.</span> <span class="nav-text">LANGUAGE JAVA|SCALA|PYTHON</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT-%E8%AF%AD%E5%8F%A5"><span class="nav-number">5.</span> <span class="nav-text">INSERT 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-INSERT-%E8%AF%AD%E5%8F%A5"><span class="nav-number">5.1.</span> <span class="nav-text">执行 INSERT 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-3"><span class="nav-number">5.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-3"><span class="nav-number">5.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86-SELECT-%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E6%8F%92%E5%85%A5%E8%A1%A8%E4%B8%AD"><span class="nav-number">5.2.</span> <span class="nav-text">将 SELECT 查询数据插入表中</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95"><span class="nav-number">5.2.1.</span> <span class="nav-text">语法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#OVERWRITE"><span class="nav-number">5.2.1.1.</span> <span class="nav-text">OVERWRITE</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#PARTITION"><span class="nav-number">5.2.1.2.</span> <span class="nav-text">PARTITION</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">5.2.2.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E5%80%BC%E6%8F%92%E5%85%A5%E8%A1%A8%E4%B8%AD"><span class="nav-number">5.3.</span> <span class="nav-text">将值插入表中</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95-1"><span class="nav-number">5.3.1.</span> <span class="nav-text">语法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#OVERWRITE-1"><span class="nav-number">5.3.1.1.</span> <span class="nav-text">OVERWRITE</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="nav-number">5.3.2.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%E5%88%B0%E5%A4%9A%E5%BC%A0%E8%A1%A8"><span class="nav-number">5.4.</span> <span class="nav-text">插入数据到多张表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95-2"><span class="nav-number">5.4.1.</span> <span class="nav-text">语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2"><span class="nav-number">5.4.2.</span> <span class="nav-text">示例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DESCRIBE-%E8%AF%AD%E5%8F%A5"><span class="nav-number">6.</span> <span class="nav-text">DESCRIBE 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-DESCRIBE-%E8%AF%AD%E5%8F%A5"><span class="nav-number">6.1.</span> <span class="nav-text">执行 DESCRIBE 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-4"><span class="nav-number">6.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-4"><span class="nav-number">6.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95-3"><span class="nav-number">6.2.</span> <span class="nav-text">语法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EXPLAIN-%E8%AF%AD%E5%8F%A5"><span class="nav-number">7.</span> <span class="nav-text">EXPLAIN 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-EXPLAIN-%E8%AF%AD%E5%8F%A5"><span class="nav-number">7.1.</span> <span class="nav-text">执行 EXPLAIN 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-5"><span class="nav-number">7.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-5"><span class="nav-number">7.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ExplainDetails"><span class="nav-number">7.2.</span> <span class="nav-text">ExplainDetails</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95-4"><span class="nav-number">7.3.</span> <span class="nav-text">语法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#USE-%E8%AF%AD%E5%8F%A5"><span class="nav-number">8.</span> <span class="nav-text">USE 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AA-USE-%E8%AF%AD%E5%8F%A5"><span class="nav-number">8.1.</span> <span class="nav-text">运行一个 USE 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-6"><span class="nav-number">8.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-6"><span class="nav-number">8.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#USE-CATALOG"><span class="nav-number">8.2.</span> <span class="nav-text">USE CATALOG</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#USE-MODULES"><span class="nav-number">8.3.</span> <span class="nav-text">USE MODULES</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#USE"><span class="nav-number">8.4.</span> <span class="nav-text">USE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SHOW-%E8%AF%AD%E5%8F%A5"><span class="nav-number">9.</span> <span class="nav-text">SHOW 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-SHOW-%E8%AF%AD%E5%8F%A5"><span class="nav-number">9.1.</span> <span class="nav-text">执行 SHOW 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-7"><span class="nav-number">9.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-7"><span class="nav-number">9.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-CATALOGS"><span class="nav-number">9.2.</span> <span class="nav-text">SHOW CATALOGS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-CURRENT-CATALOG"><span class="nav-number">9.3.</span> <span class="nav-text">SHOW CURRENT CATALOG</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-DATABASES"><span class="nav-number">9.4.</span> <span class="nav-text">SHOW DATABASES</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-CURRENT-DATABASE"><span class="nav-number">9.5.</span> <span class="nav-text">SHOW CURRENT DATABASE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-TABLES"><span class="nav-number">9.6.</span> <span class="nav-text">SHOW TABLES</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SHOW-TABLES-%E7%A4%BA%E4%BE%8B"><span class="nav-number">9.6.1.</span> <span class="nav-text">SHOW TABLES 示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-CREATE-TABLE"><span class="nav-number">9.7.</span> <span class="nav-text">SHOW CREATE TABLE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-COLUMNS"><span class="nav-number">9.8.</span> <span class="nav-text">SHOW COLUMNS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SHOW-COLUMNS-%E7%A4%BA%E4%BE%8B"><span class="nav-number">9.8.1.</span> <span class="nav-text">SHOW COLUMNS 示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-VIEWS"><span class="nav-number">9.9.</span> <span class="nav-text">SHOW VIEWS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-CREATE-VIEW"><span class="nav-number">9.10.</span> <span class="nav-text">SHOW CREATE VIEW</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-FUNCTIONS"><span class="nav-number">9.11.</span> <span class="nav-text">SHOW FUNCTIONS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-MODULES"><span class="nav-number">9.12.</span> <span class="nav-text">SHOW MODULES</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-JARS"><span class="nav-number">9.13.</span> <span class="nav-text">SHOW JARS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LOAD-%E8%AF%AD%E5%8F%A5"><span class="nav-number">10.</span> <span class="nav-text">LOAD 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-LOAD-%E8%AF%AD%E5%8F%A5"><span class="nav-number">10.1.</span> <span class="nav-text">执行 LOAD 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-8"><span class="nav-number">10.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-8"><span class="nav-number">10.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LOAD-MODULE"><span class="nav-number">10.2.</span> <span class="nav-text">LOAD MODULE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UNLOAD-%E8%AF%AD%E5%8F%A5"><span class="nav-number">11.</span> <span class="nav-text">UNLOAD 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-UNLOAD-%E8%AF%AD%E5%8F%A5"><span class="nav-number">11.1.</span> <span class="nav-text">执行 UNLOAD 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-9"><span class="nav-number">11.1.1.</span> <span class="nav-text">Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-9"><span class="nav-number">11.1.2.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UNLOAD-MODULE"><span class="nav-number">11.2.</span> <span class="nav-text">UNLOAD MODULE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SET-%E8%AF%AD%E5%8F%A5"><span class="nav-number">12.</span> <span class="nav-text">SET 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-SET-%E8%AF%AD%E5%8F%A5"><span class="nav-number">12.1.</span> <span class="nav-text">执行 SET 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-10"><span class="nav-number">12.1.1.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Syntax"><span class="nav-number">12.2.</span> <span class="nav-text">Syntax</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RESET-%E8%AF%AD%E5%8F%A5"><span class="nav-number">13.</span> <span class="nav-text">RESET 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-RESET-%E8%AF%AD%E5%8F%A5"><span class="nav-number">13.1.</span> <span class="nav-text">执行 RESET 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-11"><span class="nav-number">13.1.1.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Syntax-1"><span class="nav-number">13.2.</span> <span class="nav-text">Syntax</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JAR-%E8%AF%AD%E5%8F%A5"><span class="nav-number">14.</span> <span class="nav-text">JAR 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C-JAR-%E8%AF%AD%E5%8F%A5"><span class="nav-number">14.1.</span> <span class="nav-text">执行 JAR 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sql-12"><span class="nav-number">14.1.1.</span> <span class="nav-text">sql</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ADD-JAR"><span class="nav-number">14.2.</span> <span class="nav-text">ADD JAR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#REMOVE-JAR"><span class="nav-number">14.3.</span> <span class="nav-text">REMOVE JAR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-JARS-1"><span class="nav-number">14.4.</span> <span class="nav-text">SHOW JARS</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">maoeryu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">220</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://maoeryu.github.io/2022/08/22/flink%20sql%20ddl&dml/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="maoeryu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlyingPig">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          flink sql ddl&dml
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-08-22 00:00:00" itemprop="dateCreated datePublished" datetime="2022-08-22T00:00:00+08:00">2022-08-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2022-12-02 14:10:33" itemprop="dateModified" datetime="2022-12-02T14:10:33+08:00">2022-12-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%8D%8F%E5%90%8C%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">协同框架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本页面描述了 Flink 所支持的 SQL 语言,包括数据定义语言(Data Definition Language,DDL)/数据操纵语言(Data Manipulation Language,DML)以及查询语言.<br>Flink 对 SQL 的支持基于实现了 SQL 标准的 Apache Calcite.</p>
<p>本页面列出了目前 Flink SQL 所支持的所有语句:<br>SELECT (Queries)<br>CREATE TABLE, CATALOG, DATABASE, VIEW, FUNCTION<br>DROP TABLE, DATABASE, VIEW, FUNCTION<br>ALTER TABLE, DATABASE, FUNCTION<br>INSERT<br>SQL HINTS<br>DESCRIBE<br>EXPLAIN<br>USE<br>SHOW<br>LOAD<br>UNLOAD</p>
<span id="more"></span>
<h2 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h2><h3 id="SQL-客户端"><a href="#SQL-客户端" class="headerlink" title="SQL 客户端"></a>SQL 客户端</h3><p>SQL 客户端是一个交互式的客户端,用于向 Flink 提交 SQL 查询并将结果可视化.<br>在安装文件夹中运行 sql-client 脚本来启动 SQL 客户端.<br><code>./bin/sql-client.sh</code></p>
<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>SQL 客户端(我们的查询编辑器)启动并运行后,就可以开始编写查询了.<br>让我们使用以下简单查询打印出 &#39;Hello World&#39;:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;Hello World&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>运行 HELP 命令会列出所有支持的 SQL 语句.<br>让我们运行一个 SHOW 命令,来查看 Flink 内置函数的完整列表.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> FUNCTIONS;</span><br></pre></td></tr></table></figure>

<p>这些函数为用户在开发 SQL 查询时提供了一个功能强大的工具箱.<br>例如,CURRENT_TIMESTAMP 将在执行时打印出机器的当前系统时间.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_TIMESTAMP</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Source-表"><a href="#Source-表" class="headerlink" title="Source 表"></a>Source 表</h3><p>与所有 SQL 引擎一样,Flink 查询操作是在表上进行.<br>与传统数据库不同,Flink 不在本地管理静态数据.相反,它的查询在外部表上连续运行.</p>
<p>Flink 数据处理流水线开始于 source 表.<br>source 表产生在查询执行期间可以被操作的行.它们是查询时 FROM 子句中引用的表.<br>这些表可能是 Kafka 的 topics,数据库,文件系统,或者任何其它 Flink 知道如何消费的系统.</p>
<p>可以通过 SQL 客户端或使用环境配置文件来定义表.<br>SQL 客户端支持类似于传统 SQL 的 SQL DDL 命令.<br>标准 SQL DDL 用于创建,修改,删除表.</p>
<p>Flink 支持不同的连接器和格式相结合以定义表.<br>下面是一个示例,定义一个以 CSV 文件作为存储格式的 source 表,其中 emp_id,name,dept_id 作为 CREATE 表语句中的列.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee_information (</span><br><span class="line">  emp_id <span class="type">INT</span>,</span><br><span class="line">  name <span class="type">VARCHAR</span>,</span><br><span class="line">  dept_id <span class="type">INT</span></span><br><span class="line">) <span class="keyword">WITH</span> ( </span><br><span class="line">  <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;filesystem&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;path&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;/path/to/something.csv&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;csv&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>可以从该表中定义一个连续查询,当新行可用时读取并立即输出它们的结果.<br>例如,我们可以过滤出只在部门 1 中工作的员工.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> employee_information <span class="keyword">WHERE</span> dept_id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="连续查询"><a href="#连续查询" class="headerlink" title="连续查询"></a>连续查询</h3><p>虽然最初设计时没有考虑流语义,但 SQL 是用于构建连续数据流水线的强大工具.<br>Flink SQL 与传统数据库查询的不同之处在于,Flink SQL 持续消费到达的行并对其结果进行更新.</p>
<p>一个连续查询永远不会终止,并会产生一个动态表作为结果.<br>动态表是 Flink 中 Table API 和 SQL 对流数据支持的核心概念.</p>
<p>连续流上的聚合需要在查询执行期间不断地存储聚合的结果.<br>例如,假设你需要从传入的数据流中计算每个部门的员工人数.<br>查询需要维护每个部门最新的计算总数,以便在处理新行时及时输出结果.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  dept_id,</span><br><span class="line">  <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">as</span> emp_count </span><br><span class="line"><span class="keyword">FROM</span> employee_information </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> dept_id;</span><br></pre></td></tr></table></figure>

<p>这样的查询被认为是 有状态的.<br>Flink 的高级容错机制将维持内部状态和一致性,因此即使遇到硬件故障,查询也始终返回正确结果.</p>
<h3 id="Sink-表"><a href="#Sink-表" class="headerlink" title="Sink 表"></a>Sink 表</h3><p>当运行此查询时,SQL 客户端实时但是以只读方式提供输出.<br>存储结果,作为报表或仪表板的数据来源,需要写到另一个表.<br>这可以使用 INSERT INTO 语句来实现.<br>本节中引用的表称为 sink 表.<br>INSERT INTO 语句将作为一个独立查询被提交到 Flink 集群中.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> department_counts</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">  dept_id,</span><br><span class="line">  <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">as</span> emp_count </span><br><span class="line"><span class="keyword">FROM</span> employee_information;</span><br></pre></td></tr></table></figure>

<p>提交后,它将运行并将结果直接存储到 sink 表中,而不是将结果加载到系统内存中.</p>
<h2 id="CREATE-语句"><a href="#CREATE-语句" class="headerlink" title="CREATE 语句"></a>CREATE 语句</h2><p>CREATE 语句用于向当前或指定的 Catalog 中注册表/视图或函数.<br>注册后的表/视图和函数可以在 SQL 查询中使用.</p>
<p>目前 Flink SQL 支持下列 CREATE 语句:<br>CREATE TABLE<br>CREATE CATALOG<br>CREATE DATABASE<br>CREATE VIEW<br>CREATE FUNCTION</p>
<h3 id="执行-CREATE-语句"><a href="#执行-CREATE-语句" class="headerlink" title="执行 CREATE 语句"></a>执行 CREATE 语句</h3><h4 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 中的 executeSql() 方法执行 CREATE 语句.<br>若 CREATE 操作执行成功,executeSql() 方法返回 &#39;OK&#39;,否则会抛出异常.</p>
<p>以下的例子展示了如何在 TableEnvironment 中执行一个 CREATE 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">EnvironmentSettings settings = EnvironmentSettings.newInstance()...</span><br><span class="line">TableEnvironment tableEnv = TableEnvironment.create(settings);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对已注册的表进行 SQL 查询</span></span><br><span class="line"><span class="comment">// 注册名为 &quot;Orders&quot; 的表</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;CREATE TABLE Orders (`user` BIGINT, product STRING, amount INT) WITH (...)&quot;</span>);</span><br><span class="line"><span class="comment">// 在表上执行 SQL 查询,并把得到的结果作为一个新的表</span></span><br><span class="line">Table result = tableEnv.sqlQuery(</span><br><span class="line"> <span class="string">&quot;SELECT product, amount FROM Orders WHERE product LIKE &#x27;%Rubber%&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对已注册的表进行 INSERT 操作</span></span><br><span class="line"><span class="comment">// 注册 TableSink</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;CREATE TABLE RubberOrders(product STRING, amount INT) WITH (...)&quot;</span>);</span><br><span class="line"><span class="comment">// 在表上执行 INSERT 语句并向 TableSink 发出结果</span></span><br><span class="line">tableEnv.executeSql(</span><br><span class="line"> <span class="string">&quot;INSERT INTO RubberOrders SELECT product, amount FROM Orders WHERE product LIKE &#x27;%Rubber%&#x27;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (`<span class="keyword">user</span>` <span class="type">BIGINT</span>, product STRING, amount <span class="type">INT</span>) <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> RubberOrders (product STRING, amount <span class="type">INT</span>) <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> RubberOrders <span class="keyword">SELECT</span> product, amount <span class="keyword">FROM</span> Orders <span class="keyword">WHERE</span> product <span class="keyword">LIKE</span> <span class="string">&#x27;%Rubber%&#x27;</span>;</span><br><span class="line">[INFO] Submitting <span class="keyword">SQL</span> update statement <span class="keyword">to</span> the cluster...</span><br></pre></td></tr></table></figure>

<h3 id="CREATE-TABLE"><a href="#CREATE-TABLE" class="headerlink" title="CREATE TABLE"></a>CREATE TABLE</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [catalog_name.][db_name.]table_name</span><br><span class="line"> (</span><br><span class="line">  &#123; &lt;physical_column_definition&gt; | &lt;metadata_column_definition&gt; | &lt;computed_column_definition&gt; &#125;[ , ...n]</span><br><span class="line">  [ <span class="operator">&lt;</span>watermark_definition<span class="operator">&gt;</span> ]</span><br><span class="line">  [ <span class="operator">&lt;</span>table_constraint<span class="operator">&gt;</span> ][ , ...n]</span><br><span class="line"> )</span><br><span class="line"> [COMMENT table_comment]</span><br><span class="line"> [PARTITIONED <span class="keyword">BY</span> (partition_column_name1, partition_column_name2, ...)]</span><br><span class="line"> <span class="keyword">WITH</span> (key1<span class="operator">=</span>val1, key2<span class="operator">=</span>val2, ...)</span><br><span class="line"> [ <span class="keyword">LIKE</span> source_table [( <span class="operator">&lt;</span>like_options<span class="operator">&gt;</span> )] ]</span><br><span class="line">  </span><br><span class="line"><span class="operator">&lt;</span>physical_column_definition<span class="operator">&gt;</span>:</span><br><span class="line"> column_name column_type [ <span class="operator">&lt;</span>column_constraint<span class="operator">&gt;</span> ] [COMMENT column_comment]</span><br><span class="line"> </span><br><span class="line"><span class="operator">&lt;</span>column_constraint<span class="operator">&gt;</span>:</span><br><span class="line"> [<span class="keyword">CONSTRAINT</span> constraint_name] <span class="keyword">PRIMARY</span> KEY <span class="keyword">NOT</span> ENFORCED</span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span>table_constraint<span class="operator">&gt;</span>:</span><br><span class="line"> [<span class="keyword">CONSTRAINT</span> constraint_name] <span class="keyword">PRIMARY</span> KEY (column_name, ...) <span class="keyword">NOT</span> ENFORCED</span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span>metadata_column_definition<span class="operator">&gt;</span>:</span><br><span class="line"> column_name column_type METADATA [ <span class="keyword">FROM</span> metadata_key ] [ VIRTUAL ]</span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span>computed_column_definition<span class="operator">&gt;</span>:</span><br><span class="line"> column_name <span class="keyword">AS</span> computed_column_expression [COMMENT column_comment]</span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span>watermark_definition<span class="operator">&gt;</span>:</span><br><span class="line"> WATERMARK <span class="keyword">FOR</span> rowtime_column_name <span class="keyword">AS</span> watermark_strategy_expression</span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span>source_table<span class="operator">&gt;</span>:</span><br><span class="line"> [catalog_name.][db_name.]table_name</span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span>like_options<span class="operator">&gt;</span>:</span><br><span class="line">&#123;</span><br><span class="line">  &#123; INCLUDING | EXCLUDING &#125; &#123; ALL | CONSTRAINTS | PARTITIONS &#125;</span><br><span class="line">| &#123; INCLUDING | EXCLUDING | OVERWRITING &#125; &#123; GENERATED | OPTIONS | WATERMARKS &#125; </span><br><span class="line">&#125;[, ...]</span><br></pre></td></tr></table></figure>

<p>根据指定的表名创建一个表,如果同名表已经在 catalog 中存在了,则无法注册.</p>
<h4 id="Columns-列"><a href="#Columns-列" class="headerlink" title="Columns(列)"></a>Columns(列)</h4><h5 id="Physical-Regular-Columns-物理-常规列"><a href="#Physical-Regular-Columns-物理-常规列" class="headerlink" title="Physical / Regular Columns(物理/常规列)"></a>Physical / Regular Columns(物理/常规列)</h5><p>物理列是数据库中已知的常规列.<br>它们定义物理数据中字段的名称/类型和顺序.<br>因此,物理列表示从外部系统读取和写入的有效负载.<br>连接器和格式使用这些列(按定义的顺序)来配置自己.<br>可以在物理列之间声明其他类型的列,但不会影响最终的物理模式.</p>
<p>以下语句创建一个仅包含常规列的表:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable (</span><br><span class="line"> `user_id` <span class="type">BIGINT</span>,</span><br><span class="line"> `name` STRING</span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line"> ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h5 id="Metadata-Columns-元数据列"><a href="#Metadata-Columns-元数据列" class="headerlink" title="Metadata Columns(元数据列)"></a>Metadata Columns(元数据列)</h5><p>元数据列是 SQL 标准的扩展,允许访问连接器和/或格式化表中每一行的特定字段.<br>元数据列由METADATA关键字指示.<br>例如,元数据列可用于在 Kafka 记录中读取和写入时间戳,以进行基于时间的操作.<br>连接器和格式文档列出了每个组件的可用元数据字段.<br>但是,在表的架构中声明元数据列是可选的.</p>
<p>以下语句创建一个表,其中包含一个引用元数据字段的附加元数据列timestamp:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable (</span><br><span class="line"> `user_id` <span class="type">BIGINT</span>,</span><br><span class="line"> `name` STRING,</span><br><span class="line"> `record_time` TIMESTAMP_LTZ(<span class="number">3</span>) METADATA <span class="keyword">FROM</span> <span class="string">&#x27;timestamp&#x27;</span>    <span class="comment">-- reads and writes a Kafka record&#x27;s timestamp</span></span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line"> <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span></span><br><span class="line"> ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>每个元数据字段都由基于字符串的键标识,并具有记录的数据类型.<br>例如,Kafka 连接器公开了一个元数据字段,其中包含 可用于读取和写入记录的键timestamp和数据类型.<br>TIMESTAMP_LTZ(3)</p>
<p>在上面的示例中,元数据列record_time成为表模式的一部分,并且可以像常规列一样进行转换和存储:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> MyTable <span class="keyword">SELECT</span> user_id, name, record_time <span class="operator">+</span> <span class="type">INTERVAL</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">SECOND</span> <span class="keyword">FROM</span> MyTable;</span><br></pre></td></tr></table></figure>

<p>为方便起见,FROM如果应将列名用作标识元数据键,则可以省略该子句:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable (</span><br><span class="line"> `user_id` <span class="type">BIGINT</span>,</span><br><span class="line"> `name` STRING,</span><br><span class="line"> `<span class="type">timestamp</span>` TIMESTAMP_LTZ(<span class="number">3</span>) METADATA    <span class="comment">-- use column name as metadata key</span></span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line"> <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span></span><br><span class="line"> ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>为方便起见,如果列的数据类型与元数据字段的数据类型不同,运行时将执行显式转换.<br>当然,这要求两种数据类型兼容.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable (</span><br><span class="line"> `user_id` <span class="type">BIGINT</span>,</span><br><span class="line"> `name` STRING,</span><br><span class="line"> `<span class="type">timestamp</span>` <span class="type">BIGINT</span> METADATA    <span class="comment">-- cast the timestamp as BIGINT</span></span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line"> <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span></span><br><span class="line"> ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>默认情况下,规划器假定元数据列可用于读取和写入.<br>但是,在许多情况下,外部系统提供的只读元数据字段多于可写字段.<br>因此,可以使用VIRTUAL关键字从持久化中排除元数据列.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable (</span><br><span class="line"> `<span class="type">timestamp</span>` <span class="type">BIGINT</span> METADATA,       <span class="comment">-- part of the query-to-sink schema</span></span><br><span class="line"> `<span class="keyword">offset</span>` <span class="type">BIGINT</span> METADATA VIRTUAL,  <span class="comment">-- not part of the query-to-sink schema</span></span><br><span class="line"> `user_id` <span class="type">BIGINT</span>,</span><br><span class="line"> `name` STRING,</span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line"> <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span></span><br><span class="line"> ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在上面的示例中,这offset是一个只读元数据列,并且从 query-to-sink 架构中排除.<br>因此,源到查询模式 (for SELECT) 和查询到接收器 (for INSERT INTO) 模式不同:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">source-to-query schema:</span><br><span class="line">MyTable(&#96;timestamp&#96; BIGINT, &#96;offset&#96; BIGINT, &#96;user_id&#96; BIGINT, &#96;name&#96; STRING)</span><br><span class="line"></span><br><span class="line">query-to-sink schema:</span><br><span class="line">MyTable(&#96;timestamp&#96; BIGINT, &#96;user_id&#96; BIGINT, &#96;name&#96; STRING)</span><br></pre></td></tr></table></figure>

<h5 id="Computed-Columns-计算列"><a href="#Computed-Columns-计算列" class="headerlink" title="Computed Columns(计算列)"></a>Computed Columns(计算列)</h5><p>计算列是使用语法生成的虚拟列column_name AS computed_column_expression.</p>
<p>计算列计算一个表达式,该表达式可以引用同一个表中声明的其他列.<br>物理列和元数据列都可以访问.<br>列本身并未物理存储在表中.<br>列的数据类型是从给定的表达式自动派生的,不必手动声明.</p>
<p>规划器将在源之后将计算列转换为常规投影.<br>对于优化或水印策略下推,评估可能会分散在运算符之间,执行多次,或者如果给定查询不需要,则跳过.</p>
<p>例如,计算列可以定义为:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable (</span><br><span class="line"> `user_id` <span class="type">BIGINT</span>,</span><br><span class="line"> `price` <span class="keyword">DOUBLE</span>,</span><br><span class="line"> `quantity` <span class="keyword">DOUBLE</span>,</span><br><span class="line"> `cost` <span class="keyword">AS</span> price <span class="operator">*</span> quanitity,  <span class="comment">-- evaluate expression and supply the result to queries</span></span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line"> <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span></span><br><span class="line"> ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>表达式可以包含列/常量或函数的任意组合.<br>表达式不能包含子查询.</p>
<p>Flink 中通常使用计算列来定义语句中 的时间属性.<br>CREATE TABLE</p>
<p>使用系统的功能 可以很容易地定义处理时间属性.<br>proc AS PROCTIME()PROCTIME()<br>事件时间属性时间戳可以在WATERMARK声明之前进行预处理.<br>例如,如果原始字段不是TIMESTAMP(3)类型或嵌套在 JSON 字符串中,则可以使用计算列.</p>
<p>与虚拟元数据列类似,计算列被排除在持久化之外.<br>因此,计算列不能成为INSERT INTO语句的目标.<br>因此,源到查询模式 (for SELECT) 和查询到接收器 (for INSERT INTO) 模式不同:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">source-to-query schema:</span><br><span class="line">MyTable(&#96;user_id&#96; BIGINT, &#96;price&#96; DOUBLE, &#96;quantity&#96; DOUBLE, &#96;cost&#96; DOUBLE)</span><br><span class="line"></span><br><span class="line">query-to-sink schema:</span><br><span class="line">MyTable(&#96;user_id&#96; BIGINT, &#96;price&#96; DOUBLE, &#96;quantity&#96; DOUBLE)</span><br></pre></td></tr></table></figure>

<h4 id="WATERMARK"><a href="#WATERMARK" class="headerlink" title="WATERMARK"></a>WATERMARK</h4><p>WATERMARK 定义了表的事件时间属性,其形式为 WATERMARK FOR rowtime_column_name AS watermark_strategy_expression .</p>
<p>rowtime_column_name 把一个现有的列定义为一个为表标记事件时间的属性.<br>该列的类型必须为 TIMESTAMP(3),且是 schema 中的顶层列,它也可以是一个计算列.</p>
<p>watermark_strategy_expression 定义了 watermark 的生成策略.<br>它允许使用包括计算列在内的任意非查询表达式来计算 watermark .表达式的返回类型必须是 TIMESTAMP(3),表示了从 Epoch 以来的经过的时间.<br>返回的 watermark 只有当其不为空且其值大于之前发出的本地 watermark 时才会被发出(以保证 watermark 递增).<br>每条记录的 watermark 生成表达式计算都会由框架完成.<br>框架会定期发出所生成的最大的 watermark ,如果当前 watermark 仍然与前一个 watermark 相同/为空/或返回的 watermark 的值小于最后一个发出的 watermark ,则新的 watermark 不会被发出.<br>Watermark 根据 pipeline.auto-watermark-interval 中所配置的间隔发出.<br>若 watermark 的间隔是 0ms ,那么每条记录都会产生一个 watermark,且 watermark 会在不为空并大于上一个发出的 watermark 时发出.</p>
<p>使用事件时间语义时,表必须包含事件时间属性和 watermark 策略.</p>
<p>Flink 提供了几种常用的 watermark 策略.</p>
<ol>
<li>严格递增时间戳: WATERMARK FOR rowtime_column AS rowtime_column.<br>发出到目前为止已观察到的最大时间戳的 watermark ,时间戳大于最大时间戳的行被认为没有迟到.</li>
<li>递增时间戳: WATERMARK FOR rowtime_column AS rowtime_column - INTERVAL &#39;0.001&#39; SECOND.<br>发出到目前为止已观察到的最大时间戳减 1 的 watermark ,时间戳大于或等于最大时间戳的行被认为没有迟到.</li>
<li>有界乱序时间戳: WATERMARK FOR rowtime_column AS rowtime_column - INTERVAL &#39;string&#39; timeUnit.<br>发出到目前为止已观察到的最大时间戳减去指定延迟的 watermark ,例如, WATERMARK FOR rowtime_column AS rowtime_column - INTERVAL &#39;5&#39; SECOND 是一个 5 秒延迟的 watermark 策略.</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (</span><br><span class="line">  `<span class="keyword">user</span>` <span class="type">BIGINT</span>,</span><br><span class="line">  product STRING,</span><br><span class="line">  order_time <span class="type">TIMESTAMP</span>(<span class="number">3</span>),</span><br><span class="line">  WATERMARK <span class="keyword">FOR</span> order_time <span class="keyword">AS</span> order_time <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;5&#x27;</span> <span class="keyword">SECOND</span></span><br><span class="line">) <span class="keyword">WITH</span> ( . . . );</span><br></pre></td></tr></table></figure>

<h4 id="PRIMARY-KEY"><a href="#PRIMARY-KEY" class="headerlink" title="PRIMARY KEY"></a>PRIMARY KEY</h4><p>主键用作 Flink 优化的一种提示信息.<br>主键限制表明一张表或视图的某个(些)列是唯一的并且不包含 Null 值.<br>主键声明的列都是非 nullable 的.<br>因此主键可以被用作表行级别的唯一标识.</p>
<p>主键可以和列的定义一起声明,也可以独立声明为表的限制属性,不管是哪种方式,主键都不可以重复定义,否则 Flink 会报错.</p>
<h5 id="有效性检查"><a href="#有效性检查" class="headerlink" title="有效性检查"></a>有效性检查</h5><p>SQL 标准主键限制可以有两种模式:ENFORCED 或者 NOT ENFORCED.<br>它申明了是否输入/出数据会做合法性检查(是否唯一).<br>Flink 不存储数据因此只支持 NOT ENFORCED 模式,即不做检查,用户需要自己保证唯一性.</p>
<p>Flink 假设声明了主键的列都是不包含 Null 值的,Connector 在处理数据时需要自己保证语义正确.<br>Notes: 在 CREATE TABLE 语句中,创建主键会修改列的 nullable 属性,主键声明的列默认都是非 Nullable 的.</p>
<h4 id="PARTITIONED-BY"><a href="#PARTITIONED-BY" class="headerlink" title="PARTITIONED BY"></a>PARTITIONED BY</h4><p>根据指定的列对已经创建的表进行分区.<br>若表使用 filesystem sink ,则将会为每个分区创建一个目录.</p>
<h4 id="WITH-Options"><a href="#WITH-Options" class="headerlink" title="WITH Options"></a>WITH Options</h4><p>表属性用于创建 table source/sink ,一般用于寻找和创建底层的连接器.</p>
<p>表达式 key1=val1 的键和值必须为字符串文本常量.<br>请参考 连接外部系统 了解不同连接器所支持的属性.</p>
<p>注意: 表名可以为以下三种格式 1. catalog_name.db_name.table_name 2. db_name.table_name 3. table_name.<br>使用catalog_name.db_name.table_name 的表将会与名为 &quot;catalog_name&quot; 的 catalog 和名为 &quot;db_name&quot; 的数据库一起注册到 metastore 中.<br>使用 db_name.table_name 的表将会被注册到当前执行的 table environment 中的 catalog 且数据库会被命名为 &quot;db_name&quot;.对于 table_name, 数据表将会被注册到当前正在运行的catalog和数据库中.</p>
<p>注意: 使用 CREATE TABLE 语句注册的表均可用作 table source 和 table sink.<br>在被 DML 语句引用前,我们无法决定其实际用于 source 抑或是 sink.</p>
<h4 id="LIKE"><a href="#LIKE" class="headerlink" title="LIKE"></a>LIKE</h4><p>LIKE 子句来源于两种 SQL 特性的变体/组合(Feature T171,&quot;表定义中的 LIKE 语法&quot; 和 Feature T173,&quot;表定义中的 LIKE 语法扩展&quot;).<br>LIKE 子句可以基于现有表的定义去创建新表,并且可以扩展或排除原始表中的某些部分.<br>与 SQL 标准相反,LIKE 子句必须在 CREATE 语句中定义,并且是基于 CREATE 语句的更上层定义,这是因为 LIKE 子句可以用于定义表的多个部分,而不仅仅是 schema 部分.</p>
<p>你可以使用该子句,重用(或改写)指定的连接器配置属性或者可以向外部表添加 watermark 定义,例如可以向 Apache Hive 中定义的表添加 watermark 定义.</p>
<p>示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (</span><br><span class="line">  `<span class="keyword">user</span>` <span class="type">BIGINT</span>,</span><br><span class="line">  product STRING,</span><br><span class="line">  order_time <span class="type">TIMESTAMP</span>(<span class="number">3</span>)</span><br><span class="line">) <span class="keyword">WITH</span> ( </span><br><span class="line">  <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;scan.startup.mode&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;earliest-offset&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders_with_watermark (</span><br><span class="line">  <span class="comment">-- 添加 watermark 定义</span></span><br><span class="line">  WATERMARK <span class="keyword">FOR</span> order_time <span class="keyword">AS</span> order_time <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;5&#x27;</span> <span class="keyword">SECOND</span> </span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line">  <span class="comment">-- 改写 startup-mode 属性</span></span><br><span class="line">  <span class="string">&#x27;scan.startup.mode&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;latest-offset&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">LIKE</span> Orders;</span><br></pre></td></tr></table></figure>

<p>结果表 Orders_with_watermark 等效于使用以下语句创建的表:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders_with_watermark (</span><br><span class="line">  `<span class="keyword">user</span>` <span class="type">BIGINT</span>,</span><br><span class="line">  product STRING,</span><br><span class="line">  order_time <span class="type">TIMESTAMP</span>(<span class="number">3</span>),</span><br><span class="line">  WATERMARK <span class="keyword">FOR</span> order_time <span class="keyword">AS</span> order_time <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;5&#x27;</span> <span class="keyword">SECOND</span> </span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line">  <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;scan.startup.mode&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;latest-offset&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>表属性的合并逻辑可以用 like options 来控制.<br>可以控制合并的表属性如下:</p>
<ol>
<li>CONSTRAINTS - 主键和唯一键约束</li>
<li>GENERATED - 计算列</li>
<li>OPTIONS - 连接器信息/格式化方式等配置项</li>
<li>PARTITIONS - 表分区信息</li>
<li>WATERMARKS - watermark 定义</li>
</ol>
<p>并且有三种不同的表属性合并策略:</p>
<ol>
<li>INCLUDING - 新表包含源表(source table)所有的表属性,如果和源表的表属性重复则会直接失败,例如新表和源表存在相同 key 的属性.</li>
<li>EXCLUDING - 新表不包含源表指定的任何表属性.</li>
<li>OVERWRITING - 新表包含源表的表属性,但如果出现重复项,则会用新表的表属性覆盖源表中的重复表属性,例如,两个表中都存在相同 key 的属性,则会使用当前语句中定义的 key 的属性值.</li>
</ol>
<p>并且你可以使用 INCLUDING/EXCLUDING ALL 这种声明方式来指定使用怎样的合并策略,例如使用 EXCLUDING ALL INCLUDING WATERMARKS,那么代表只有源表的 WATERMARKS 属性才会被包含进新表.</p>
<p>示例如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 存储在文件系统的源表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders_in_file (</span><br><span class="line">  `<span class="keyword">user</span>` <span class="type">BIGINT</span>,</span><br><span class="line">  product STRING,</span><br><span class="line">  order_time_string STRING,</span><br><span class="line">  order_time <span class="keyword">AS</span> to_timestamp(order_time)</span><br><span class="line">)</span><br><span class="line">PARTITIONED <span class="keyword">BY</span> (`<span class="keyword">user</span>`) </span><br><span class="line"><span class="keyword">WITH</span> ( </span><br><span class="line">  <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;filesystem&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;path&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;...&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 对应存储在 kafka 的源表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders_in_kafka (</span><br><span class="line">  <span class="comment">-- 添加 watermark 定义</span></span><br><span class="line">  WATERMARK <span class="keyword">FOR</span> order_time <span class="keyword">AS</span> order_time <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;5&#x27;</span> <span class="keyword">SECOND</span> </span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line">  <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">  ...</span><br><span class="line">)</span><br><span class="line"><span class="keyword">LIKE</span> Orders_in_file (</span><br><span class="line">  <span class="comment">-- 排除需要生成 watermark 的计算列之外的所有内容.</span></span><br><span class="line">  <span class="comment">-- 去除不适用于 kafka 的所有分区和文件系统的相关属性.</span></span><br><span class="line">  EXCLUDING <span class="keyword">ALL</span></span><br><span class="line">  INCLUDING GENERATED</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>如果未提供 like 配置项(like options),默认将使用 INCLUDING ALL OVERWRITING OPTIONS 的合并策略.</p>
<p>注意: 您无法选择物理列的合并策略,当物理列进行合并时就如使用了 INCLUDING 策略.</p>
<p>注意: 源表 source_table 可以是一个组合 ID.<br>您可以指定不同 catalog 或者 DB 的表作为源表: 例如,my_catalog.my_db.MyTable 指定了源表 MyTable 来源于名为 MyCatalog 的 catalog 和名为 my_db 的 DB ,my_db.MyTable 指定了源表 MyTable 来源于当前 catalog 和名为 my_db 的 DB.</p>
<h3 id="CREATE-CATALOG"><a href="#CREATE-CATALOG" class="headerlink" title="CREATE CATALOG"></a>CREATE CATALOG</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> CATALOG catalog_name</span><br><span class="line"> <span class="keyword">WITH</span> (key1<span class="operator">=</span>val1, key2<span class="operator">=</span>val2, ...)</span><br></pre></td></tr></table></figure>

<p>使用给定的目录属性创建目录.如果已经存在同名目录,则抛出异常.</p>
<h4 id="WITH-OPTIONS"><a href="#WITH-OPTIONS" class="headerlink" title="WITH OPTIONS"></a>WITH OPTIONS</h4><p>用于存储与此目录相关的额外信息的目录属性.表达式的键和值都key1=val1应该是字符串字面量.</p>
<h3 id="CREATE-DATABASE"><a href="#CREATE-DATABASE" class="headerlink" title="CREATE DATABASE"></a>CREATE DATABASE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [catalog_name.]db_name</span><br><span class="line"> [COMMENT database_comment]</span><br><span class="line"> <span class="keyword">WITH</span> (key1<span class="operator">=</span>val1, key2<span class="operator">=</span>val2, ...)</span><br></pre></td></tr></table></figure>

<p>根据给定的表属性创建数据库.<br>若数据库中已存在同名表会抛出异常.</p>
<h4 id="IF-NOT-EXISTS"><a href="#IF-NOT-EXISTS" class="headerlink" title="IF NOT EXISTS"></a>IF NOT EXISTS</h4><p>若数据库已经存在,则不会进行任何操作.</p>
<h4 id="WITH-OPTIONS-1"><a href="#WITH-OPTIONS-1" class="headerlink" title="WITH OPTIONS"></a>WITH OPTIONS</h4><p>数据库属性一般用于存储关于这个数据库额外的信息.<br>表达式 key1=val1 中的键和值都需要是字符串文本常量.</p>
<h3 id="CREATE-VIEW"><a href="#CREATE-VIEW" class="headerlink" title="CREATE VIEW"></a>CREATE VIEW</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">VIEW</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [catalog_name.][db_name.]view_name</span><br><span class="line"> [&#123;columnName [, columnName ]* &#125;] [COMMENT view_comment]</span><br><span class="line"> <span class="keyword">AS</span> query_expression</span><br></pre></td></tr></table></figure>

<p>根据给定的 query 语句创建一个视图.<br>若数据库中已经存在同名视图会抛出异常.</p>
<h4 id="TEMPORARY"><a href="#TEMPORARY" class="headerlink" title="TEMPORARY"></a>TEMPORARY</h4><p>创建一个有 catalog 和数据库命名空间的临时视图,并覆盖原有的视图.</p>
<h4 id="IF-NOT-EXISTS-1"><a href="#IF-NOT-EXISTS-1" class="headerlink" title="IF NOT EXISTS"></a>IF NOT EXISTS</h4><p>若该视图已经存在,则不会进行任何操作.</p>
<h3 id="CREATE-FUNCTION"><a href="#CREATE-FUNCTION" class="headerlink" title="CREATE FUNCTION"></a>CREATE FUNCTION</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [TEMPORARY<span class="operator">|</span>TEMPORARY <span class="keyword">SYSTEM</span>] <span class="keyword">FUNCTION</span></span><br><span class="line"> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] [[catalog_name.]db_name.]function_name</span><br><span class="line"> <span class="keyword">AS</span> identifier [<span class="keyword">LANGUAGE</span> JAVA<span class="operator">|</span>SCALA<span class="operator">|</span>PYTHON]</span><br></pre></td></tr></table></figure>

<p>创建一个有 catalog 和数据库命名空间的 catalog function ,需要指定一个 identifier ,可指定 language tag .<br>若 catalog 中,已经有同名的函数注册了,则无法注册.</p>
<p>如果 language tag 是 JAVA 或者 SCALA ,则 identifier 是 UDF 实现类的全限定名.<br>关于 JAVA/SCALA UDF 的实现,请参考 自定义函数.</p>
<p>如果 language tag 是 PYTHON,则 identifier 是 UDF 对象的全限定名,例如 pyflink.table.tests.test_udf.add.<br>关于 PYTHON UDF 的实现,请参考 Python UDFs.</p>
<p>如果 language tag 是 PYTHON,而当前程序是 Java／Scala 程序或者纯 SQL 程序,则需要配置 Python 相关的依赖.</p>
<h4 id="TEMPORARY-1"><a href="#TEMPORARY-1" class="headerlink" title="TEMPORARY"></a>TEMPORARY</h4><p>创建一个有 catalog 和数据库命名空间的临时 catalog function ,并覆盖原有的 catalog function .</p>
<h4 id="TEMPORARY-SYSTEM"><a href="#TEMPORARY-SYSTEM" class="headerlink" title="TEMPORARY SYSTEM"></a>TEMPORARY SYSTEM</h4><p>创建一个没有数据库命名空间的临时系统 catalog function ,并覆盖系统内置的函数.</p>
<h4 id="IF-NOT-EXISTS-2"><a href="#IF-NOT-EXISTS-2" class="headerlink" title="IF NOT EXISTS"></a>IF NOT EXISTS</h4><p>若该函数已经存在,则不会进行任何操作.</p>
<h4 id="LANGUAGE-JAVA-SCALA-PYTHON"><a href="#LANGUAGE-JAVA-SCALA-PYTHON" class="headerlink" title="LANGUAGE JAVA|SCALA|PYTHON"></a>LANGUAGE JAVA|SCALA|PYTHON</h4><p>Language tag 用于指定 Flink runtime 如何执行这个函数.<br>目前,只支持 JAVA, SCALA 和 PYTHON,且函数的默认语言为 JAVA.</p>
<h2 id="DROP-语句"><a href="#DROP-语句" class="headerlink" title="DROP 语句"></a>DROP 语句</h2><p>DROP 语句可用于删除指定的 catalog,也可用于从当前或指定的 Catalog 中删除一个已经注册的表/视图或函数.</p>
<p>Flink SQL 目前支持以下 DROP 语句:<br>DROP CATALOG<br>DROP TABLE<br>DROP DATABASE<br>DROP VIEW<br>DROP FUNCTION</p>
<h3 id="执行-DROP-语句"><a href="#执行-DROP-语句" class="headerlink" title="执行 DROP 语句"></a>执行 DROP 语句</h3><h4 id="Java-1"><a href="#Java-1" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 中的 executeSql() 方法执行 DROP 语句.<br>若 DROP 操作执行成功,executeSql() 方法返回 &#39;OK&#39;,否则会抛出异常.</p>
<p>以下的例子展示了如何在 TableEnvironment 中执行一个 DROP 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TableEnvironment tableEnv = TableEnvironment.create(...);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册名为 &quot;Orders&quot; 的表</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;CREATE TABLE Orders (`user` BIGINT, product STRING, amount INT) WITH (...)&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串数组: [&quot;Orders&quot;]</span></span><br><span class="line">String[] tables = tableEnv.listTables();</span><br><span class="line"><span class="comment">// or tableEnv.executeSql(&quot;SHOW TABLES&quot;).print();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 从 catalog 删除 &quot;Orders&quot; 表</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;DROP TABLE Orders&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 空字符串数组</span></span><br><span class="line">String[] tables = tableEnv.listTables();</span><br><span class="line"><span class="comment">// or tableEnv.executeSql(&quot;SHOW TABLES&quot;).print();</span></span><br></pre></td></tr></table></figure>

<h4 id="sql-1"><a href="#sql-1" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (`<span class="keyword">user</span>` <span class="type">BIGINT</span>, product STRING, amount <span class="type">INT</span>) <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line">Orders</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> Orders;</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been removed.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line">[INFO] <span class="keyword">Result</span> was empty.</span><br></pre></td></tr></table></figure>

<h3 id="DROP-CATALOG"><a href="#DROP-CATALOG" class="headerlink" title="DROP CATALOG"></a>DROP CATALOG</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> CATALOG [IF <span class="keyword">EXISTS</span>] catalog_name</span><br></pre></td></tr></table></figure>

<p>删除给定名字的 catalog.</p>
<h4 id="IF-EXISTS"><a href="#IF-EXISTS" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4><p>如果目标 catalog 不存在,则不会执行任何操作.</p>
<h3 id="DROP-TABLE"><a href="#DROP-TABLE" class="headerlink" title="DROP TABLE"></a>DROP TABLE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>] [catalog_name.][db_name.]table_name</span><br></pre></td></tr></table></figure>

<p>根据给定的表名删除某个表.<br>若需要删除的表不存在,则抛出异常.</p>
<h4 id="IF-EXISTS-1"><a href="#IF-EXISTS-1" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4><p>表不存在时不会进行任何操作.</p>
<h3 id="DROP-DATABASE"><a href="#DROP-DATABASE" class="headerlink" title="DROP DATABASE"></a>DROP DATABASE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE [IF <span class="keyword">EXISTS</span>] [catalog_name.]db_name [ (RESTRICT <span class="operator">|</span> CASCADE) ]</span><br></pre></td></tr></table></figure>

<p>根据给定的表名删除数据库.<br>若需要删除的数据库不存在会抛出异常 .</p>
<h4 id="IF-EXISTS-2"><a href="#IF-EXISTS-2" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4><p>若数据库不存在,不执行任何操作.</p>
<h4 id="RESTRICT"><a href="#RESTRICT" class="headerlink" title="RESTRICT"></a>RESTRICT</h4><p>当删除一个非空数据库时,会触发异常.<br>(默认为开)</p>
<h4 id="CASCADE"><a href="#CASCADE" class="headerlink" title="CASCADE"></a>CASCADE</h4><p>删除一个非空数据库时,把相关联的表与函数一并删除.</p>
<h3 id="DROP-VIEW"><a href="#DROP-VIEW" class="headerlink" title="DROP VIEW"></a>DROP VIEW</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> [TEMPORARY] <span class="keyword">VIEW</span>  [IF <span class="keyword">EXISTS</span>] [catalog_name.][db_name.]view_name</span><br></pre></td></tr></table></figure>

<p>删除一个有 catalog 和数据库命名空间的视图.<br>若需要删除的视图不存在,则会产生异常.</p>
<h4 id="TEMPORARY-2"><a href="#TEMPORARY-2" class="headerlink" title="TEMPORARY"></a>TEMPORARY</h4><p>删除一个有 catalog 和数据库命名空间的临时视图.</p>
<h4 id="IF-EXISTS-3"><a href="#IF-EXISTS-3" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4><p>若视图不存在,则不会进行任何操作.</p>
<p>依赖管理 Flink 没有使用 CASCADE / RESTRICT 关键字来维护视图的依赖关系,当前的方案是在用户使用视图时再提示错误信息,比如在视图的底层表已经被删除等场景.</p>
<h3 id="DROP-FUNCTION"><a href="#DROP-FUNCTION" class="headerlink" title="DROP FUNCTION"></a>DROP FUNCTION</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> [TEMPORARY<span class="operator">|</span>TEMPORARY <span class="keyword">SYSTEM</span>] <span class="keyword">FUNCTION</span> [IF <span class="keyword">EXISTS</span>] [catalog_name.][db_name.]function_name;</span><br></pre></td></tr></table></figure>

<p>删除一个有 catalog 和数据库命名空间的 catalog function.<br>若需要删除的函数不存在,则会产生异常.</p>
<h4 id="TEMPORARY-3"><a href="#TEMPORARY-3" class="headerlink" title="TEMPORARY"></a>TEMPORARY</h4><p>删除一个有 catalog 和数据库命名空间的临时 catalog function.</p>
<h4 id="TEMPORARY-SYSTEM-1"><a href="#TEMPORARY-SYSTEM-1" class="headerlink" title="TEMPORARY SYSTEM"></a>TEMPORARY SYSTEM</h4><p>删除一个没有数据库命名空间的临时系统函数.</p>
<h4 id="IF-EXISTS-4"><a href="#IF-EXISTS-4" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4><p>若函数不存在,则不会进行任何操作.</p>
<h2 id="ALTER-语句"><a href="#ALTER-语句" class="headerlink" title="ALTER 语句"></a>ALTER 语句</h2><p>ALTER 语句用于修改一个已经在 Catalog 中注册的表/视图或函数定义.</p>
<p>Flink SQL 目前支持以下 ALTER 语句:<br>ALTER TABLE<br>ALTER VIEW<br>ALTER DATABASE<br>ALTER FUNCTION</p>
<h3 id="执行-ALTER-语句"><a href="#执行-ALTER-语句" class="headerlink" title="执行 ALTER 语句"></a>执行 ALTER 语句</h3><h4 id="Java-2"><a href="#Java-2" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 中的 executeSql() 方法执行 ALTER 语句.<br>若 ALTER 操作执行成功,executeSql() 方法返回 &#39;OK&#39;,否则会抛出异常.</p>
<p>以下的例子展示了如何在 TableEnvironment 中执行一个 ALTER 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TableEnvironment tableEnv = TableEnvironment.create(...);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册名为 &quot;Orders&quot; 的表</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;CREATE TABLE Orders (`user` BIGINT, product STRING, amount INT) WITH (...)&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串数组: [&quot;Orders&quot;]</span></span><br><span class="line">String[] tables = tableEnv.listTables();</span><br><span class="line"><span class="comment">// or tableEnv.executeSql(&quot;SHOW TABLES&quot;).print();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把 &quot;Orders&quot; 的表名改为 &quot;NewOrders&quot;</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;ALTER TABLE Orders RENAME TO NewOrders;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串数组:[&quot;NewOrders&quot;]</span></span><br><span class="line">String[] tables = tableEnv.listTables();</span><br><span class="line"><span class="comment">// or tableEnv.executeSql(&quot;SHOW TABLES&quot;).print();</span></span><br></pre></td></tr></table></figure>

<h4 id="sql-2"><a href="#sql-2" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (`<span class="keyword">user</span>` <span class="type">BIGINT</span>, product STRING, amount <span class="type">INT</span>) <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line">Orders</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> Orders RENAME <span class="keyword">TO</span> NewOrders;</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been removed.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line">NewOrders</span><br></pre></td></tr></table></figure>

<h3 id="ALTER-TABLE"><a href="#ALTER-TABLE" class="headerlink" title="ALTER TABLE"></a>ALTER TABLE</h3><h4 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> [catalog_name.][db_name.]table_name RENAME <span class="keyword">TO</span> new_table_name</span><br></pre></td></tr></table></figure>

<p>把原有的表名更改为新的表名.</p>
<h4 id="设置或修改表属性"><a href="#设置或修改表属性" class="headerlink" title="设置或修改表属性"></a>设置或修改表属性</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> [catalog_name.][db_name.]table_name <span class="keyword">SET</span> (key1<span class="operator">=</span>val1, key2<span class="operator">=</span>val2, ...)</span><br></pre></td></tr></table></figure>

<p>为指定的表设置一个或多个属性.<br>若个别属性已经存在于表中,则使用新的值覆盖旧的值.</p>
<h3 id="ALTER-VIEW"><a href="#ALTER-VIEW" class="headerlink" title="ALTER VIEW"></a>ALTER VIEW</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> [catalog_name.][db_name.]view_name RENAME <span class="keyword">TO</span> new_view_name</span><br></pre></td></tr></table></figure>

<p>Renames a given view to a new name within the same catalog and database.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> [catalog_name.][db_name.]view_name <span class="keyword">AS</span> new_query_expression</span><br></pre></td></tr></table></figure>

<p>Changes the underlying query defining the given view to a new query.</p>
<h3 id="ALTER-DATABASE"><a href="#ALTER-DATABASE" class="headerlink" title="ALTER DATABASE"></a>ALTER DATABASE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE [catalog_name.]db_name <span class="keyword">SET</span> (key1<span class="operator">=</span>val1, key2<span class="operator">=</span>val2, ...)</span><br></pre></td></tr></table></figure>

<p>在数据库中设置一个或多个属性.<br>若个别属性已经在数据库中设定,将会使用新值覆盖旧值.</p>
<h3 id="ALTER-FUNCTION"><a href="#ALTER-FUNCTION" class="headerlink" title="ALTER FUNCTION"></a>ALTER FUNCTION</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> [TEMPORARY<span class="operator">|</span>TEMPORARY <span class="keyword">SYSTEM</span>] <span class="keyword">FUNCTION</span></span><br><span class="line"> [IF <span class="keyword">EXISTS</span>] [catalog_name.][db_name.]function_name</span><br><span class="line"> <span class="keyword">AS</span> identifier [<span class="keyword">LANGUAGE</span> JAVA<span class="operator">|</span>SCALA<span class="operator">|</span>PYTHON]</span><br></pre></td></tr></table></figure>

<p>修改一个有 catalog 和数据库命名空间的 catalog function ,需要指定一个新的 identifier ,可指定 language tag .<br>若函数不存在,删除会抛出异常.</p>
<p>如果 language tag 是 JAVA 或者 SCALA ,则 identifier 是 UDF 实现类的全限定名.<br>关于 JAVA/SCALA UDF 的实现,请参考 自定义函数.</p>
<p>如果 language tag 是 PYTHON , 则 identifier 是 UDF 对象的全限定名,例如 pyflink.table.tests.test_udf.add.<br>关于 PYTHON UDF 的实现,请参考 Python UDFs.</p>
<h4 id="TEMPORARY-4"><a href="#TEMPORARY-4" class="headerlink" title="TEMPORARY"></a>TEMPORARY</h4><p>修改一个有 catalog 和数据库命名空间的临时 catalog function ,并覆盖原有的 catalog function .</p>
<h4 id="TEMPORARY-SYSTEM-2"><a href="#TEMPORARY-SYSTEM-2" class="headerlink" title="TEMPORARY SYSTEM"></a>TEMPORARY SYSTEM</h4><p>修改一个没有数据库命名空间的临时系统 catalog function ,并覆盖系统内置的函数.</p>
<h4 id="IF-EXISTS-5"><a href="#IF-EXISTS-5" class="headerlink" title="IF EXISTS"></a>IF EXISTS</h4><p>若函数不存在,则不进行任何操作.</p>
<h4 id="LANGUAGE-JAVA-SCALA-PYTHON-1"><a href="#LANGUAGE-JAVA-SCALA-PYTHON-1" class="headerlink" title="LANGUAGE JAVA|SCALA|PYTHON"></a>LANGUAGE JAVA|SCALA|PYTHON</h4><p>Language tag 用于指定 Flink runtime 如何执行这个函数.<br>目前,只支持 JAVA,SCALA 和 PYTHON,且函数的默认语言为 JAVA.</p>
<h2 id="INSERT-语句"><a href="#INSERT-语句" class="headerlink" title="INSERT 语句"></a>INSERT 语句</h2><p>INSERT 语句用来向表中添加行.</p>
<h3 id="执行-INSERT-语句"><a href="#执行-INSERT-语句" class="headerlink" title="执行 INSERT 语句"></a>执行 INSERT 语句</h3><h4 id="Java-3"><a href="#Java-3" class="headerlink" title="Java"></a>Java</h4><p>单条 INSERT 语句,可以使用 TableEnvironment 中的 executeSql() 方法执行.<br>executeSql() 方法执行 INSERT 语句时会立即提交一个 Flink 作业,并且返回一个 TableResult 对象,通过该对象可以获取 JobClient 方便的操作提交的作业.<br>多条 INSERT 语句,使用 TableEnvironment 中的 createStatementSet 创建一个 StatementSet 对象,然后使用 StatementSet 中的 addInsertSql() 方法添加多条 INSERT 语句,最后通过 StatementSet 中的 execute() 方法来执行.</p>
<p>以下的例子展示了如何在 TableEnvironment 中执行一条 INSERT 语句,或者通过 StatementSet 执行多条 INSERT 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">TableEnvironment tEnv = TableEnvironment.create(...);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册一个 &quot;Orders&quot; 源表,和 &quot;RubberOrders&quot; 结果表</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE TABLE Orders (`user` BIGINT, product VARCHAR, amount INT) WITH (...)&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE TABLE RubberOrders(product VARCHAR, amount INT) WITH (...)&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行一条 INSERT 语句,将源表的数据输出到结果表中</span></span><br><span class="line">TableResult tableResult1 = tEnv.executeSql(</span><br><span class="line"> <span class="string">&quot;INSERT INTO RubberOrders SELECT product, amount FROM Orders WHERE product LIKE &#x27;%Rubber%&#x27;&quot;</span>);</span><br><span class="line"><span class="comment">// 通过 TableResult 来获取作业状态</span></span><br><span class="line">System.out.println(tableResult1.getJobClient().get().getJobStatus());</span><br><span class="line"></span><br><span class="line"><span class="comment">//----------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// 注册一个 &quot;GlassOrders&quot; 结果表用于运行多 INSERT 语句</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE TABLE GlassOrders(product VARCHAR, amount INT) WITH (...)&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 运行多条 INSERT 语句,将原表数据输出到多个结果表中</span></span><br><span class="line">StatementSet stmtSet = tEnv.createStatementSet();</span><br><span class="line"><span class="comment">// `addInsertSql` 方法每次只接收单条 INSERT 语句</span></span><br><span class="line">stmtSet.addInsertSql(</span><br><span class="line"> <span class="string">&quot;INSERT INTO RubberOrders SELECT product, amount FROM Orders WHERE product LIKE &#x27;%Rubber%&#x27;&quot;</span>);</span><br><span class="line">stmtSet.addInsertSql(</span><br><span class="line"> <span class="string">&quot;INSERT INTO GlassOrders SELECT product, amount FROM Orders WHERE product LIKE &#x27;%Glass%&#x27;&quot;</span>);</span><br><span class="line"><span class="comment">// 执行刚刚添加的所有 INSERT 语句</span></span><br><span class="line">TableResult tableResult2 = stmtSet.execute();</span><br><span class="line"><span class="comment">// 通过 TableResult 来获取作业状态</span></span><br><span class="line">System.out.println(tableResult1.getJobClient().get().getJobStatus());</span><br></pre></td></tr></table></figure>

<h4 id="sql-3"><a href="#sql-3" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (`<span class="keyword">user</span>` <span class="type">BIGINT</span>, product STRING, amount <span class="type">INT</span>) <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> RubberOrders(product STRING, amount <span class="type">INT</span>) <span class="keyword">WITH</span> (...);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line">Orders</span><br><span class="line">RubberOrders</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> RubberOrders <span class="keyword">SELECT</span> product, amount <span class="keyword">FROM</span> Orders <span class="keyword">WHERE</span> product <span class="keyword">LIKE</span> <span class="string">&#x27;%Rubber%&#x27;</span>;</span><br><span class="line">[INFO] Submitting <span class="keyword">SQL</span> update statement <span class="keyword">to</span> the cluster...</span><br><span class="line">[INFO] <span class="keyword">Table</span> update statement has been successfully submitted <span class="keyword">to</span> the cluster:</span><br></pre></td></tr></table></figure>

<h3 id="将-SELECT-查询数据插入表中"><a href="#将-SELECT-查询数据插入表中" class="headerlink" title="将 SELECT 查询数据插入表中"></a>将 SELECT 查询数据插入表中</h3><p>通过 INSERT 语句,可以将查询的结果插入到表中,</p>
<h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[EXECUTE] INSERT &#123; INTO | OVERWRITE &#125; [catalog_name.][db_name.]table_name [PARTITION part_spec] select_statement</span><br><span class="line"></span><br><span class="line">part_spec:</span><br><span class="line"> (part_col_name1<span class="operator">=</span>val1 [, part_col_name2<span class="operator">=</span>val2, ...])</span><br></pre></td></tr></table></figure>

<h5 id="OVERWRITE"><a href="#OVERWRITE" class="headerlink" title="OVERWRITE"></a>OVERWRITE</h5><p>INSERT OVERWRITE 将会覆盖表中或分区中的任何已存在的数据.<br>否则,新数据会追加到表中或分区中.</p>
<h5 id="PARTITION"><a href="#PARTITION" class="headerlink" title="PARTITION"></a>PARTITION</h5><p>PARTITION 语句应该包含需要插入的静态分区列与值.</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个分区表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> country_page_view (<span class="keyword">user</span> STRING, cnt <span class="type">INT</span>, <span class="type">date</span> STRING, country STRING)</span><br><span class="line">PARTITIONED <span class="keyword">BY</span> (<span class="type">date</span>, country)</span><br><span class="line"><span class="keyword">WITH</span> (...)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 追加行到该静态分区中 (date=&#x27;2019-8-30&#x27;, country=&#x27;China&#x27;)</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> country_page_view <span class="keyword">PARTITION</span> (<span class="type">date</span><span class="operator">=</span><span class="string">&#x27;2019-8-30&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;China&#x27;</span>)</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="keyword">user</span>, cnt <span class="keyword">FROM</span> page_view_source;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Insert语句的开头可以额外增加EXECUTE关键字,带EXECUTE关键字和不带是等价的</span></span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> country_page_view <span class="keyword">PARTITION</span> (<span class="type">date</span><span class="operator">=</span><span class="string">&#x27;2019-8-30&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;China&#x27;</span>)</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="keyword">user</span>, cnt <span class="keyword">FROM</span> page_view_source;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 追加行到分区 (date, country) 中,其中 date 是静态分区 &#x27;2019-8-30&#x27;.country 是动态分区,其值由每一行动态决定</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> country_page_view <span class="keyword">PARTITION</span> (<span class="type">date</span><span class="operator">=</span><span class="string">&#x27;2019-8-30&#x27;</span>)</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="keyword">user</span>, cnt, country <span class="keyword">FROM</span> page_view_source;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 覆盖行到静态分区 (date=&#x27;2019-8-30&#x27;, country=&#x27;China&#x27;)</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE country_page_view <span class="keyword">PARTITION</span> (<span class="type">date</span><span class="operator">=</span><span class="string">&#x27;2019-8-30&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;China&#x27;</span>)</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="keyword">user</span>, cnt <span class="keyword">FROM</span> page_view_source;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 覆盖行到分区 (date, country) 中,其中 date 是静态分区 &#x27;2019-8-30&#x27;.country 是动态分区,其值由每一行动态决定</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE country_page_view <span class="keyword">PARTITION</span> (<span class="type">date</span><span class="operator">=</span><span class="string">&#x27;2019-8-30&#x27;</span>)</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="keyword">user</span>, cnt, country <span class="keyword">FROM</span> page_view_source;</span><br></pre></td></tr></table></figure>

<h3 id="将值插入表中"><a href="#将值插入表中" class="headerlink" title="将值插入表中"></a>将值插入表中</h3><p>通过 INSERT 语句,也可以直接将值插入到表中,</p>
<h4 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[EXECUTE] INSERT &#123; INTO | OVERWRITE &#125; [catalog_name.][db_name.]table_name VALUES values_row [, values_row ...]</span><br><span class="line"></span><br><span class="line">values_row:</span><br><span class="line">  : (val1 [, val2, ...])</span><br></pre></td></tr></table></figure>

<h5 id="OVERWRITE-1"><a href="#OVERWRITE-1" class="headerlink" title="OVERWRITE"></a>OVERWRITE</h5><p>INSERT OVERWRITE 将会覆盖表中的任何已存在的数据.<br>否则,新数据会追加到表中.</p>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (name STRING, age <span class="type">INT</span>, gpa <span class="type">DECIMAL</span>(<span class="number">3</span>, <span class="number">2</span>)) <span class="keyword">WITH</span> (...);</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> students</span><br><span class="line"> <span class="keyword">VALUES</span> (<span class="string">&#x27;fred flintstone&#x27;</span>, <span class="number">35</span>, <span class="number">1.28</span>), (<span class="string">&#x27;barney rubble&#x27;</span>, <span class="number">32</span>, <span class="number">2.32</span>);</span><br></pre></td></tr></table></figure>

<h3 id="插入数据到多张表"><a href="#插入数据到多张表" class="headerlink" title="插入数据到多张表"></a>插入数据到多张表</h3><p>STATEMENT SET 可以实现通过一个语句插入数据到多个表.</p>
<h4 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> STATEMENT <span class="keyword">SET</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">insert_statement;</span><br><span class="line">...</span><br><span class="line">insert_statement;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line">insert_statement:</span><br><span class="line">  <span class="operator">&lt;</span>insert_from_select<span class="operator">&gt;</span><span class="operator">|</span><span class="operator">&lt;</span>insert_from_values<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (name STRING, age <span class="type">INT</span>, gpa <span class="type">DECIMAL</span>(<span class="number">3</span>, <span class="number">2</span>)) <span class="keyword">WITH</span> (...);</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXECUTE</span> STATEMENT <span class="keyword">SET</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students</span><br><span class="line"> <span class="keyword">VALUES</span> (<span class="string">&#x27;fred flintstone&#x27;</span>, <span class="number">35</span>, <span class="number">1.28</span>), (<span class="string">&#x27;barney rubble&#x27;</span>, <span class="number">32</span>, <span class="number">2.32</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students</span><br><span class="line"> <span class="keyword">VALUES</span> (<span class="string">&#x27;fred flintstone&#x27;</span>, <span class="number">35</span>, <span class="number">1.28</span>), (<span class="string">&#x27;barney rubble&#x27;</span>, <span class="number">32</span>, <span class="number">2.32</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h2 id="DESCRIBE-语句"><a href="#DESCRIBE-语句" class="headerlink" title="DESCRIBE 语句"></a>DESCRIBE 语句</h2><p>DESCRIBE 语句用于描述表或视图的 schema.</p>
<h3 id="执行-DESCRIBE-语句"><a href="#执行-DESCRIBE-语句" class="headerlink" title="执行 DESCRIBE 语句"></a>执行 DESCRIBE 语句</h3><h4 id="Java-4"><a href="#Java-4" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 的 executeSql() 方法执行 DESCRIBE 语句.<br>如果 DESCRIBE 操作执行成功,executeSql() 方法会返回给定表的 schema,否则会抛出异常.</p>
<p>以下示例展示了如何在 TableEnvironment 中执行一条 DESCRIBE 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">TableEnvironment tableEnv = TableEnvironment.create(...);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册名为 &quot;Orders&quot; 的表</span></span><br><span class="line">tableEnv.executeSql(</span><br><span class="line">      <span class="string">&quot;CREATE TABLE Orders (&quot;</span> +</span><br><span class="line">      <span class="string">&quot; `user` BIGINT NOT NULl,&quot;</span> +</span><br><span class="line">      <span class="string">&quot; product VARCHAR(32),&quot;</span> +</span><br><span class="line">      <span class="string">&quot; amount INT,&quot;</span> +</span><br><span class="line">      <span class="string">&quot; ts TIMESTAMP(3),&quot;</span> +</span><br><span class="line">      <span class="string">&quot; ptime AS PROCTIME(),&quot;</span> +</span><br><span class="line">      <span class="string">&quot; PRIMARY KEY(`user`) NOT ENFORCED,&quot;</span> +</span><br><span class="line">      <span class="string">&quot; WATERMARK FOR ts AS ts - INTERVAL &#x27;1&#x27; SECONDS&quot;</span> +</span><br><span class="line">      <span class="string">&quot;) with (...)&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印 schema</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;DESCRIBE Orders&quot;</span>).print();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印 schema</span></span><br><span class="line">tableEnv.executeSql(<span class="string">&quot;DESC Orders&quot;</span>).print();</span><br></pre></td></tr></table></figure>

<p>上述示例的结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+---------+----------------------------------+-------+-----------+-----------------+----------------------------+</span><br><span class="line">|    name |                             type |  null |       key | computed column |                  watermark |</span><br><span class="line">+---------+----------------------------------+-------+-----------+-----------------+----------------------------+</span><br><span class="line">|    user |                           BIGINT | false | PRI(user) |                 |                            |</span><br><span class="line">| product |                      VARCHAR(32) |  true |           |                 |                            |</span><br><span class="line">|  amount |                              INT |  true |           |                 |                            |</span><br><span class="line">|      ts |           TIMESTAMP(3) *ROWTIME* |  true |           |                 | &#96;ts&#96; - INTERVAL &#39;1&#39; SECOND |</span><br><span class="line">|   ptime | TIMESTAMP(3) NOT NULL *PROCTIME* | false |           |      PROCTIME() |                            |</span><br><span class="line">+---------+----------------------------------+-------+-----------+-----------------+----------------------------+</span><br><span class="line">5 rows in set</span><br></pre></td></tr></table></figure>

<h4 id="sql-4"><a href="#sql-4" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Orders (</span><br><span class="line">  `<span class="keyword">user</span>` <span class="type">BIGINT</span> <span class="keyword">NOT</span> <span class="keyword">NULl</span>,</span><br><span class="line">  product <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">  amount <span class="type">INT</span>,</span><br><span class="line">  ts <span class="type">TIMESTAMP</span>(<span class="number">3</span>),</span><br><span class="line">  ptime <span class="keyword">AS</span> PROCTIME(),</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY(`<span class="keyword">user</span>`) <span class="keyword">NOT</span> ENFORCED,</span><br><span class="line">  WATERMARK <span class="keyword">FOR</span> ts <span class="keyword">AS</span> ts <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;1&#x27;</span> SECONDS</span><br><span class="line"> ) <span class="keyword">with</span> (</span><br><span class="line">  ...</span><br><span class="line"> );</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESCRIBE</span> Orders;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> Orders;</span><br></pre></td></tr></table></figure>

<p>上述示例的结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root</span><br><span class="line"> |-- user: BIGINT NOT NULL</span><br><span class="line"> |-- product: VARCHAR(32)</span><br><span class="line"> |-- amount: INT</span><br><span class="line"> |-- ts: TIMESTAMP(3) *ROWTIME*</span><br><span class="line"> |-- ptime: TIMESTAMP(3) NOT NULL *PROCTIME* AS PROCTIME()</span><br><span class="line"> |-- WATERMARK FOR ts AS &#96;ts&#96; - INTERVAL &#39;1&#39; SECOND</span><br><span class="line"> |-- CONSTRAINT PK_3599338 PRIMARY KEY (user)</span><br></pre></td></tr></table></figure>

<h3 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; DESCRIBE | DESC &#125; [catalog_name.][db_name.]table_name</span><br></pre></td></tr></table></figure>

<h2 id="EXPLAIN-语句"><a href="#EXPLAIN-语句" class="headerlink" title="EXPLAIN 语句"></a>EXPLAIN 语句</h2><p>EXPLAIN 语句用于解释 query 或 INSERT 语句的执行逻辑,也用于优化 query 语句的查询计划.</p>
<h3 id="执行-EXPLAIN-语句"><a href="#执行-EXPLAIN-语句" class="headerlink" title="执行 EXPLAIN 语句"></a>执行 EXPLAIN 语句</h3><h4 id="Java-5"><a href="#Java-5" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 的 executeSql() 方法执行 EXPLAIN 语句.<br>如果 EXPLAIN 操作执行成功,executeSql() 方法会返回解释结果,否则会抛出异常.</p>
<p>以下示例展示了如何在 TableEnvironment 中执行一条 EXPLAIN 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">StreamTableEnvironment tEnv = StreamTableEnvironment.create(env);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册名为 &quot;Orders&quot; 的表</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE TABLE MyTable1 (`count` bigint, word VARCHAR(256)) WITH (&#x27;connector&#x27; = &#x27;datagen&#x27;)&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE TABLE MyTable2 (`count` bigint, word VARCHAR(256)) WITH (&#x27;connector&#x27; = &#x27;datagen&#x27;)&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 TableEnvironment.explainSql() 来解释 SELECT 语句</span></span><br><span class="line">String explanation = tEnv.explainSql(</span><br><span class="line"> <span class="string">&quot;SELECT `count`, word FROM MyTable1 WHERE word LIKE &#x27;F%&#x27; &quot;</span> +</span><br><span class="line"> <span class="string">&quot;UNION ALL &quot;</span> + </span><br><span class="line"> <span class="string">&quot;SELECT `count`, word FROM MyTable2&quot;</span>);</span><br><span class="line">System.out.println(explanation);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 TableEnvironment.executeSql() 来解释 SELECT 语句</span></span><br><span class="line">TableResult tableResult = tEnv.executeSql(</span><br><span class="line"> <span class="string">&quot;EXPLAIN PLAN FOR &quot;</span> + </span><br><span class="line"> <span class="string">&quot;SELECT `count`, word FROM MyTable1 WHERE word LIKE &#x27;F%&#x27; &quot;</span> +</span><br><span class="line"> <span class="string">&quot;UNION ALL &quot;</span> + </span><br><span class="line"> <span class="string">&quot;SELECT `count`, word FROM MyTable2&quot;</span>);</span><br><span class="line">tableResult.print();</span><br><span class="line"></span><br><span class="line">TableResult tableResult2 = tEnv.executeSql(</span><br><span class="line"> <span class="string">&quot;EXPLAIN ESTIMATED_COST, CHANGELOG_MODE, JSON_EXECUTION_PLAN &quot;</span> + </span><br><span class="line"> <span class="string">&quot;SELECT `count`, word FROM MyTable1 WHERE word LIKE &#x27;F%&#x27; &quot;</span> +</span><br><span class="line"> <span class="string">&quot;UNION ALL &quot;</span> + </span><br><span class="line"> <span class="string">&quot;SELECT `count`, word FROM MyTable2&quot;</span>);</span><br><span class="line">tableResult2.print();</span><br></pre></td></tr></table></figure>

<h4 id="sql-5"><a href="#sql-5" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable1 (`count` <span class="type">bigint</span>, word <span class="type">VARCHAR</span>(<span class="number">256</span>)) <span class="keyword">WITH</span> (<span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;datagen&#x27;</span>);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> MyTable2 (`count` <span class="type">bigint</span>, word <span class="type">VARCHAR</span>(<span class="number">256</span>)) <span class="keyword">WITH</span> (<span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;datagen&#x27;</span>);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line">EXPLAIN PLAN <span class="keyword">FOR</span> <span class="keyword">SELECT</span> `count`, word <span class="keyword">FROM</span> MyTable1 <span class="keyword">WHERE</span> word <span class="keyword">LIKE</span> <span class="string">&#x27;F%&#x27;</span> </span><br><span class="line"> <span class="keyword">UNION</span> <span class="keyword">ALL</span> </span><br><span class="line"> <span class="keyword">SELECT</span> `count`, word <span class="keyword">FROM</span> MyTable2;</span><br><span class="line">                                  </span><br><span class="line">EXPLAIN ESTIMATED_COST, CHANGELOG_MODE, JSON_EXECUTION_PLAN <span class="keyword">SELECT</span> `count`, word <span class="keyword">FROM</span> MyTable1 </span><br><span class="line"> <span class="keyword">WHERE</span> word <span class="keyword">LIKE</span> <span class="string">&#x27;F%&#x27;</span> </span><br><span class="line"> <span class="keyword">UNION</span> <span class="keyword">ALL</span> </span><br><span class="line"> <span class="keyword">SELECT</span> `count`, word <span class="keyword">FROM</span> MyTable2;</span><br></pre></td></tr></table></figure>

<h3 id="ExplainDetails"><a href="#ExplainDetails" class="headerlink" title="ExplainDetails"></a>ExplainDetails</h3><p>使用指定的 explainDetail 类型来打印语句的计划.</p>
<p>ESTIMATED_COST:生成优化器(optimizer)估算的物理节点相关的成本信息,<br>例如:TableSourceScan(..., cumulative cost ={1.0E8 rows, 1.0E8 cpu, 2.4E9 io, 0.0 network, 0.0 memory})</p>
<p>CHANGELOG_MODE:为每个物理 RelNode 生成 changelog mode.</p>
<p>例如:GroupAggregate(..., changelogMode=[I,UA,D])</p>
<p>JSON_EXECUTION_PLAN:生成 json 格式的程序执行计划.</p>
<h3 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN [([ExplainDetail[, ExplainDetail]<span class="operator">*</span>]) <span class="operator">|</span> PLAN <span class="keyword">FOR</span>] <span class="operator">&lt;</span>query_statement_or_insert_statement_or_statement_set<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">statement_set:</span><br><span class="line"><span class="keyword">EXECUTE</span> STATEMENT <span class="keyword">SET</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">insert_statement;</span><br><span class="line">...</span><br><span class="line">insert_statement;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h2 id="USE-语句"><a href="#USE-语句" class="headerlink" title="USE 语句"></a>USE 语句</h2><p>USE 语句用来设置当前的 catalog 或者 database.</p>
<h3 id="运行一个-USE-语句"><a href="#运行一个-USE-语句" class="headerlink" title="运行一个 USE 语句"></a>运行一个 USE 语句</h3><h4 id="Java-6"><a href="#Java-6" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 中的 executeSql() 方法执行 USE 语句.<br>若 USE 操作执行成功,executeSql() 方法返回 &#39;OK&#39;,否则会抛出异常.</p>
<p>以下的例子展示了如何在 TableEnvironment 中执行一个 USE 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">StreamTableEnvironment tEnv = StreamTableEnvironment.create(env);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a catalog</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE CATALOG cat1 WITH (...)&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW CATALOGS&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-----------------+</span></span><br><span class="line"><span class="comment">// |    catalog name |</span></span><br><span class="line"><span class="comment">// +-----------------+</span></span><br><span class="line"><span class="comment">// | default_catalog |</span></span><br><span class="line"><span class="comment">// | cat1            |</span></span><br><span class="line"><span class="comment">// +-----------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// change default catalog</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;USE CATALOG cat1&quot;</span>);</span><br><span class="line"></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW DATABASES&quot;</span>).print();</span><br><span class="line"><span class="comment">// databases are empty</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// | database name |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a database</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE DATABASE db1 WITH (...)&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW DATABASES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// | database name |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// |        db1    |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// change default database</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;USE db1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// change module resolution order and enabled status</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;USE MODULES hive&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW FULL MODULES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-------------+-------+</span></span><br><span class="line"><span class="comment">// | module name |  used |</span></span><br><span class="line"><span class="comment">// +-------------+-------+</span></span><br><span class="line"><span class="comment">// |        hive |  true |</span></span><br><span class="line"><span class="comment">// |        core | false |</span></span><br><span class="line"><span class="comment">// +-------------+-------+</span></span><br></pre></td></tr></table></figure>

<h4 id="sql-6"><a href="#sql-6" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> CATALOG cat1 <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] Catalog has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> CATALOGS;</span><br><span class="line">default_catalog</span><br><span class="line">cat1</span><br><span class="line"></span><br><span class="line">USE CATALOG cat1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE db1 <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] Database has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line">db1</span><br><span class="line"></span><br><span class="line">USE db1;</span><br><span class="line"></span><br><span class="line">USE MODULES hive;</span><br><span class="line">[INFO] Use modules succeeded<span class="operator">!</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> MODULES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">module</span> name <span class="operator">|</span>  used <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+-------+</span></span><br><span class="line"><span class="operator">|</span>        hive <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        core <span class="operator">|</span> <span class="literal">false</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<h3 id="USE-CATALOG"><a href="#USE-CATALOG" class="headerlink" title="USE CATALOG"></a>USE CATALOG</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE CATALOG catalog_name</span><br></pre></td></tr></table></figure>

<p>设置当前的 catalog.<br>所有后续命令未显式指定 catalog 的将使用此 catalog.<br>如果指定的的 catalog 不存在,则抛出异常.<br>默认的当前 catalog 是 default_catalog.</p>
<h3 id="USE-MODULES"><a href="#USE-MODULES" class="headerlink" title="USE MODULES"></a>USE MODULES</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE MODULES module_name1[, module_name2, ...]</span><br></pre></td></tr></table></figure>

<p>使用声明的顺序设置启用的模块.<br>所有后续命令将解析启用模块内的元数据(函数/用户定义类型/规则等)并遵循解析顺序.<br>加载时默认使用模块.<br>如果没有被USE MODULES语句使用,加载的模块将被禁用.<br>默认加载和启用的模块是core.</p>
<h3 id="USE"><a href="#USE" class="headerlink" title="USE"></a>USE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE [catalog_name.]database_name</span><br></pre></td></tr></table></figure>

<p>设置当前的 database.<br>所有后续命令未显式指定 database 的将使用此 database.<br>如果指定的的 database 不存在,则抛出异常.<br>默认的当前 database 是 default_database.</p>
<h2 id="SHOW-语句"><a href="#SHOW-语句" class="headerlink" title="SHOW 语句"></a>SHOW 语句</h2><p>SHOW 语句用于列出其相应父对象中的对象,例如 catalog/database/table 和 view/column/function 和 module.<br>有关详细信息和其他选项,请参见各个命令.</p>
<p>SHOW CREATE 语句用于打印给定对象的创建 DDL 语句.<br>当前的 SHOW CREATE 语句仅在打印给定表和视图的 DDL 语句时可用.</p>
<p>目前 Flink SQL 支持下列 SHOW 语句:<br>SHOW CATALOGS<br>SHOW CURRENT CATALOG<br>SHOW DATABASES<br>SHOW CURRENT DATABASE<br>SHOW TABLES<br>SHOW CREATE TABLE<br>SHOW COLUMNS<br>SHOW VIEWS<br>SHOW CREATE VIEW<br>SHOW FUNCTIONS<br>SHOW MODULES<br>SHOW FULL MODULES<br>SHOW JARS</p>
<h3 id="执行-SHOW-语句"><a href="#执行-SHOW-语句" class="headerlink" title="执行 SHOW 语句"></a>执行 SHOW 语句</h3><h4 id="Java-7"><a href="#Java-7" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 中的 executeSql() 方法执行 SHOW 语句.<br>若 SHOW 操作执行成功,executeSql() 方法返回所有对象,否则会抛出异常.</p>
<p>以下的例子展示了如何在 TableEnvironment 中执行一个 SHOW 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">StreamTableEnvironment tEnv = StreamTableEnvironment.create(env);</span><br><span class="line"></span><br><span class="line"><span class="comment">// show catalogs</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW CATALOGS&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-----------------+</span></span><br><span class="line"><span class="comment">// |    catalog name |</span></span><br><span class="line"><span class="comment">// +-----------------+</span></span><br><span class="line"><span class="comment">// | default_catalog |</span></span><br><span class="line"><span class="comment">// +-----------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show current catalog</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW CURRENT CATALOG&quot;</span>).print();</span><br><span class="line"><span class="comment">// +----------------------+</span></span><br><span class="line"><span class="comment">// | current catalog name |</span></span><br><span class="line"><span class="comment">// +----------------------+</span></span><br><span class="line"><span class="comment">// |      default_catalog |</span></span><br><span class="line"><span class="comment">// +----------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show databases</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW DATABASES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +------------------+</span></span><br><span class="line"><span class="comment">// |    database name |</span></span><br><span class="line"><span class="comment">// +------------------+</span></span><br><span class="line"><span class="comment">// | default_database |</span></span><br><span class="line"><span class="comment">// +------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show current database</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW CURRENT DATABASE&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-----------------------+</span></span><br><span class="line"><span class="comment">// | current database name |</span></span><br><span class="line"><span class="comment">// +-----------------------+</span></span><br><span class="line"><span class="comment">// |      default_database |</span></span><br><span class="line"><span class="comment">// +-----------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a table</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE TABLE my_table (...) WITH (...)&quot;</span>);</span><br><span class="line"><span class="comment">// show tables</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW TABLES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +------------+</span></span><br><span class="line"><span class="comment">// | table name |</span></span><br><span class="line"><span class="comment">// +------------+</span></span><br><span class="line"><span class="comment">// |   my_table |</span></span><br><span class="line"><span class="comment">// +------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show create table</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW CREATE TABLE my_table&quot;</span>).print();</span><br><span class="line"><span class="comment">// CREATE TABLE `default_catalog`.`default_db`.`my_table` (</span></span><br><span class="line"><span class="comment">//   ...</span></span><br><span class="line"><span class="comment">// ) WITH (</span></span><br><span class="line"><span class="comment">//   ...</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show columns</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW COLUMNS FROM my_table LIKE &#x27;%f%&#x27;&quot;</span>).print();</span><br><span class="line"><span class="comment">// +--------+-------+------+-----+--------+-----------+</span></span><br><span class="line"><span class="comment">// |   name |  type | null | key | extras | watermark |</span></span><br><span class="line"><span class="comment">// +--------+-------+------+-----+--------+-----------+</span></span><br><span class="line"><span class="comment">// | field2 | BYTES | true |     |        |           |</span></span><br><span class="line"><span class="comment">// +--------+-------+------+-----+--------+-----------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a view</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE VIEW my_view AS SELECT * FROM my_table&quot;</span>);</span><br><span class="line"><span class="comment">// show views</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW VIEWS&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-----------+</span></span><br><span class="line"><span class="comment">// | view name |</span></span><br><span class="line"><span class="comment">// +-----------+</span></span><br><span class="line"><span class="comment">// |   my_view |</span></span><br><span class="line"><span class="comment">// +-----------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show create view</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW CREATE VIEW my_view&quot;</span>).print();</span><br><span class="line"><span class="comment">// CREATE VIEW `default_catalog`.`default_db`.`my_view`(`field1`, `field2`, ...) as</span></span><br><span class="line"><span class="comment">// SELECT *</span></span><br><span class="line"><span class="comment">// FROM `default_catalog`.`default_database`.`my_table`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show functions</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW FUNCTIONS&quot;</span>).print();</span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// | function name |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// |           mod |</span></span><br><span class="line"><span class="comment">// |        sha256 |</span></span><br><span class="line"><span class="comment">// |           ... |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a user defined function</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;CREATE FUNCTION f1 AS ...&quot;</span>);</span><br><span class="line"><span class="comment">// show user defined functions</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW USER FUNCTIONS&quot;</span>).print();</span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// | function name |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"><span class="comment">// |            f1 |</span></span><br><span class="line"><span class="comment">// |           ... |</span></span><br><span class="line"><span class="comment">// +---------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show modules</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW MODULES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-------------+</span></span><br><span class="line"><span class="comment">// | module name |</span></span><br><span class="line"><span class="comment">// +-------------+</span></span><br><span class="line"><span class="comment">// |        core |</span></span><br><span class="line"><span class="comment">// +-------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// show full modules</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW FULL MODULES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-------------+-------+</span></span><br><span class="line"><span class="comment">// | module name |  used |</span></span><br><span class="line"><span class="comment">// +-------------+-------+</span></span><br><span class="line"><span class="comment">// |        core |  true |</span></span><br><span class="line"><span class="comment">// |        hive | false |</span></span><br><span class="line"><span class="comment">// +-------------+-------+</span></span><br></pre></td></tr></table></figure>

<h4 id="sql-7"><a href="#sql-7" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> CATALOGS;</span><br><span class="line">default_catalog</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line">default_database</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_table (...) <span class="keyword">WITH</span> (...);</span><br><span class="line">[INFO] <span class="keyword">Table</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line">my_table</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_table;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `default_catalog`.`default_db`.`my_table` (</span><br><span class="line">  ...</span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line">  ...</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> COLUMNS <span class="keyword">from</span> MyUserTable <span class="keyword">LIKE</span> <span class="string">&#x27;%f%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+------+-----+--------+-----------+</span></span><br><span class="line"><span class="operator">|</span>   name <span class="operator">|</span>  type <span class="operator">|</span> <span class="keyword">null</span> <span class="operator">|</span> key <span class="operator">|</span> extras <span class="operator">|</span> watermark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+------+-----+--------+-----------+</span></span><br><span class="line"><span class="operator">|</span> field2 <span class="operator">|</span> BYTES <span class="operator">|</span> <span class="literal">true</span> <span class="operator">|</span>     <span class="operator">|</span>        <span class="operator">|</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+------+-----+--------+-----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> my_view <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> my_table;</span><br><span class="line">[INFO] <span class="keyword">View</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> VIEWS;</span><br><span class="line">my_view</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> my_view;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> `default_catalog`.`default_db`.`my_view`(`field1`, `field2`, ...) <span class="keyword">as</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> `default_catalog`.`default_database`.`my_table`</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> FUNCTIONS;</span><br><span class="line">mod</span><br><span class="line">sha256</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> f1 <span class="keyword">AS</span> ...;</span><br><span class="line">[INFO] <span class="keyword">Function</span> has been created.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">USER</span> FUNCTIONS;</span><br><span class="line">f1</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> MODULES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">module</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span>        core <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> MODULES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">module</span> name <span class="operator">|</span> used <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="operator">|</span>        core <span class="operator">|</span> <span class="literal">true</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> JARS;</span><br><span class="line"><span class="operator">/</span>path<span class="operator">/</span><span class="keyword">to</span><span class="operator">/</span>addedJar.jar</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-CATALOGS"><a href="#SHOW-CATALOGS" class="headerlink" title="SHOW CATALOGS"></a>SHOW CATALOGS</h3><p>SHOW CATALOGS<br>展示所有的 catalog.</p>
<h3 id="SHOW-CURRENT-CATALOG"><a href="#SHOW-CURRENT-CATALOG" class="headerlink" title="SHOW CURRENT CATALOG"></a>SHOW CURRENT CATALOG</h3><p>SHOW CURRENT CATALOG<br>显示当前正在使用的 catalog.</p>
<h3 id="SHOW-DATABASES"><a href="#SHOW-DATABASES" class="headerlink" title="SHOW DATABASES"></a>SHOW DATABASES</h3><p>SHOW DATABASES<br>展示当前 catalog 中所有的 database.</p>
<h3 id="SHOW-CURRENT-DATABASE"><a href="#SHOW-CURRENT-DATABASE" class="headerlink" title="SHOW CURRENT DATABASE"></a>SHOW CURRENT DATABASE</h3><p>SHOW CURRENT DATABASE<br>显示当前正在使用的 database.</p>
<h3 id="SHOW-TABLES"><a href="#SHOW-TABLES" class="headerlink" title="SHOW TABLES"></a>SHOW TABLES</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES [ ( <span class="keyword">FROM</span> <span class="operator">|</span> <span class="keyword">IN</span> ) [catalog_name.]database_name ] [ [<span class="keyword">NOT</span>] <span class="keyword">LIKE</span> <span class="operator">&lt;</span>sql_like_pattern<span class="operator">&gt;</span> ]</span><br></pre></td></tr></table></figure>

<p>展示指定库的所有表,如果没有指定库则展示当前库的所有表.<br>另外返回的结果能被一个可选的匹配字符串过滤.</p>
<p>LIKE 根据可选的 LIKE 语句展示给定库中与 <code>&lt;sql_like_pattern&gt;</code> 是否模糊相似的所有表.</p>
<p>LIKE 子句中 sql 正则式的语法与 MySQL 方言中的语法相同.</p>
<p>% 匹配任意数量的字符, 也包括0数量字符, <code>\%</code> 匹配一个 % 字符.<br>_ 只匹配一个字符, <code>\_</code> 匹配一个 _ 字符.</p>
<h4 id="SHOW-TABLES-示例"><a href="#SHOW-TABLES-示例" class="headerlink" title="SHOW TABLES 示例"></a>SHOW TABLES 示例</h4><p>假定在 catalog1 的 db1 库有如下表:<br>person<br>dim</p>
<p>在会话的当前库下有如下表:<br>fights<br>orders</p>
<p>显示指定库的所有表.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables <span class="keyword">from</span> db1;</span><br><span class="line"><span class="comment">-- show tables from catalog1.db1;</span></span><br><span class="line"><span class="comment">-- show tables in db1;</span></span><br><span class="line"><span class="comment">-- show tables in catalog1.db1;</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">table</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span>        dim <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     person <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<p>显示指定库中相似于指定 SQL 正则式的所有表.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables <span class="keyword">from</span> db1 <span class="keyword">like</span> <span class="string">&#x27;%n&#x27;</span>;</span><br><span class="line"><span class="comment">-- show tables from catalog1.db1 like &#x27;%n&#x27;;</span></span><br><span class="line"><span class="comment">-- show tables in db1 like &#x27;%n&#x27;;</span></span><br><span class="line"><span class="comment">-- show tables in catalog1.db1 like &#x27;%n&#x27;;</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">table</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span>     person <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<p>显示指定库中不相似于指定 SQL 正则式的所有表.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables <span class="keyword">from</span> db1 <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">&#x27;%n&#x27;</span>;</span><br><span class="line"><span class="comment">-- show tables from catalog1.db1 not like &#x27;%n&#x27;;</span></span><br><span class="line"><span class="comment">-- show tables in db1 not like &#x27;%n&#x27;;</span></span><br><span class="line"><span class="comment">-- show tables in catalog1.db1 not like &#x27;%n&#x27;;</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">table</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span>        dim <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<p>显示当前库中的所有表.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">table</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span>      items <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     orders <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<h3 id="SHOW-CREATE-TABLE"><a href="#SHOW-CREATE-TABLE" class="headerlink" title="SHOW CREATE TABLE"></a>SHOW CREATE TABLE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [catalog_name.][db_name.]table_name</span><br></pre></td></tr></table></figure>

<p>展示创建指定表的 create 语句.<br>Attention 目前 SHOW CREATE TABLE 只支持通过 Flink SQL DDL 创建的表.</p>
<h3 id="SHOW-COLUMNS"><a href="#SHOW-COLUMNS" class="headerlink" title="SHOW COLUMNS"></a>SHOW COLUMNS</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> COLUMNS ( <span class="keyword">FROM</span> <span class="operator">|</span> <span class="keyword">IN</span> ) [[catalog_name.]database.]<span class="operator">&lt;</span>table_name<span class="operator">&gt;</span> [ [<span class="keyword">NOT</span>] <span class="keyword">LIKE</span> <span class="operator">&lt;</span>sql_like_pattern<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure>

<p>展示给定表的所有列.<br>LIKE 根据可选的 LIKE 语句展示给定表中与 <code>&lt;sql_like_pattern&gt;</code> 是否模糊相似的所有列.</p>
<p>LIKE 子句中 sql 正则式的语法与 MySQL 方言中的语法相同.</p>
<h4 id="SHOW-COLUMNS-示例"><a href="#SHOW-COLUMNS-示例" class="headerlink" title="SHOW COLUMNS 示例"></a>SHOW COLUMNS 示例</h4><p>假定在 catalog1 catalog 中的 database1 数据库中有名为 orders 的表,其结构如下所示:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+---------+-----------------------------+-------+-----------+---------------+----------------------------+</span><br><span class="line">|    name |                        type |  null |       key |        extras |                  watermark |</span><br><span class="line">+---------+-----------------------------+-------+-----------+---------------+----------------------------+</span><br><span class="line">|    user |                      BIGINT | false | PRI(user) |               |                            |</span><br><span class="line">| product |                 VARCHAR(32) |  true |           |               |                            |</span><br><span class="line">|  amount |                         INT |  true |           |               |                            |</span><br><span class="line">|      ts |      TIMESTAMP(3) *ROWTIME* |  true |           |               | &#96;ts&#96; - INTERVAL &#39;1&#39; SECOND |</span><br><span class="line">|   ptime | TIMESTAMP_LTZ(3) *PROCTIME* | false |           | AS PROCTIME() |                            |</span><br><span class="line">+---------+-----------------------------+-------+-----------+---------------+----------------------------+</span><br></pre></td></tr></table></figure>

<p>显示指定表中的所有列.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> columns <span class="keyword">from</span> orders;</span><br><span class="line"><span class="comment">-- show columns from database1.orders;</span></span><br><span class="line"><span class="comment">-- show columns from catalog1.database1.orders;</span></span><br><span class="line"><span class="comment">-- show columns in orders;</span></span><br><span class="line"><span class="comment">-- show columns in database1.orders;</span></span><br><span class="line"><span class="comment">-- show columns in catalog1.database1.orders;</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------------------+-------+-----------+---------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span>    name <span class="operator">|</span>                        type <span class="operator">|</span>  <span class="keyword">null</span> <span class="operator">|</span>       key <span class="operator">|</span>        extras <span class="operator">|</span>                  watermark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------------------+-------+-----------+---------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="keyword">user</span> <span class="operator">|</span>                      <span class="type">BIGINT</span> <span class="operator">|</span> <span class="literal">false</span> <span class="operator">|</span> PRI(<span class="keyword">user</span>) <span class="operator">|</span>               <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> product <span class="operator">|</span>                 <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span>           <span class="operator">|</span>               <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  amount <span class="operator">|</span>                         <span class="type">INT</span> <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span>           <span class="operator">|</span>               <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      ts <span class="operator">|</span>      <span class="type">TIMESTAMP</span>(<span class="number">3</span>) <span class="operator">*</span>ROWTIME<span class="operator">*</span> <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span>           <span class="operator">|</span>               <span class="operator">|</span> `ts` <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">SECOND</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   ptime <span class="operator">|</span> TIMESTAMP_LTZ(<span class="number">3</span>) <span class="operator">*</span>PROCTIME<span class="operator">*</span> <span class="operator">|</span> <span class="literal">false</span> <span class="operator">|</span>           <span class="operator">|</span> <span class="keyword">AS</span> PROCTIME() <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------------------+-------+-----------+---------------+----------------------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<p>显示指定表中相似于指定 SQL 正则式的所有列.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> columns <span class="keyword">from</span> orders <span class="keyword">like</span> <span class="string">&#x27;%r&#x27;</span>;</span><br><span class="line"><span class="comment">-- show columns from database1.orders like &#x27;%r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns from catalog1.database1.orders like &#x27;%r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns in orders like &#x27;%r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns in database1.orders like &#x27;%r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns in catalog1.database1.orders like &#x27;%r&#x27;;</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------+-----------+--------+-----------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span>   type <span class="operator">|</span>  <span class="keyword">null</span> <span class="operator">|</span>       key <span class="operator">|</span> extras <span class="operator">|</span> watermark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------+-----------+--------+-----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">user</span> <span class="operator">|</span> <span class="type">BIGINT</span> <span class="operator">|</span> <span class="literal">false</span> <span class="operator">|</span> PRI(<span class="keyword">user</span>) <span class="operator">|</span>        <span class="operator">|</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------+-----------+--------+-----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<p>显示指定表中不相似于指定 SQL 正则式的所有列.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> columns <span class="keyword">from</span> orders <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">&#x27;%_r&#x27;</span>;</span><br><span class="line"><span class="comment">-- show columns from database1.orders not like &#x27;%_r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns from catalog1.database1.orders not like &#x27;%_r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns in orders not like &#x27;%_r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns in database1.orders not like &#x27;%_r&#x27;;</span></span><br><span class="line"><span class="comment">-- show columns in catalog1.database1.orders not like &#x27;%_r&#x27;;</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------------------+-------+-----+---------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span>    name <span class="operator">|</span>                        type <span class="operator">|</span>  <span class="keyword">null</span> <span class="operator">|</span> key <span class="operator">|</span>        extras <span class="operator">|</span>                  watermark <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------------------+-------+-----+---------------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span> product <span class="operator">|</span>                 <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span>     <span class="operator">|</span>               <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  amount <span class="operator">|</span>                         <span class="type">INT</span> <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span>     <span class="operator">|</span>               <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      ts <span class="operator">|</span>      <span class="type">TIMESTAMP</span>(<span class="number">3</span>) <span class="operator">*</span>ROWTIME<span class="operator">*</span> <span class="operator">|</span>  <span class="literal">true</span> <span class="operator">|</span>     <span class="operator">|</span>               <span class="operator">|</span> `ts` <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">SECOND</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   ptime <span class="operator">|</span> TIMESTAMP_LTZ(<span class="number">3</span>) <span class="operator">*</span>PROCTIME<span class="operator">*</span> <span class="operator">|</span> <span class="literal">false</span> <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">AS</span> PROCTIME() <span class="operator">|</span>                            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------------------+-------+-----+---------------+----------------------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<h3 id="SHOW-VIEWS"><a href="#SHOW-VIEWS" class="headerlink" title="SHOW VIEWS"></a>SHOW VIEWS</h3><p>SHOW VIEWS<br>展示当前 catalog 和当前 database 中所有的视图.</p>
<h3 id="SHOW-CREATE-VIEW"><a href="#SHOW-CREATE-VIEW" class="headerlink" title="SHOW CREATE VIEW"></a>SHOW CREATE VIEW</h3><p><code>SHOW CREATE VIEW [catalog_name.][db_name.]view_name</code><br>展示创建指定视图的 create 语句.</p>
<h3 id="SHOW-FUNCTIONS"><a href="#SHOW-FUNCTIONS" class="headerlink" title="SHOW FUNCTIONS"></a>SHOW FUNCTIONS</h3><p><code>SHOW [USER] FUNCTIONS</code><br>展示当前 catalog 和当前 database 中所有的 function,包括:系统 function 和用户定义的 function.</p>
<p>USER 仅仅展示当前 catalog 和当前 database 中用户定义的 function.</p>
<h3 id="SHOW-MODULES"><a href="#SHOW-MODULES" class="headerlink" title="SHOW MODULES"></a>SHOW MODULES</h3><p><code>SHOW [FULL] MODULES</code><br>展示当前环境激活的所有 module.<br>FULL 展示当前环境加载的所有 module 及激活状态.</p>
<h3 id="SHOW-JARS"><a href="#SHOW-JARS" class="headerlink" title="SHOW JARS"></a>SHOW JARS</h3><p>SHOW JARS<br>展示所有通过 ADD JAR 语句加入到 session classloader 中的 jar.<br>Attention 当前 SHOW JARS 命令只能在 SQL CLI 中使用.</p>
<h2 id="LOAD-语句"><a href="#LOAD-语句" class="headerlink" title="LOAD 语句"></a>LOAD 语句</h2><p>LOAD 语句用于加载内置的或用户自定义的模块.</p>
<h3 id="执行-LOAD-语句"><a href="#执行-LOAD-语句" class="headerlink" title="执行 LOAD 语句"></a>执行 LOAD 语句</h3><h4 id="Java-8"><a href="#Java-8" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 的 executeSql() 方法执行 LOAD 语句.<br>如果 LOAD 操作执行成功,executeSql() 方法会返回 &#39;OK&#39;,否则会抛出异常.</p>
<p>以下示例展示了如何在 TableEnvironment 中执行一条 LOAD 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">StreamTableEnvironment tEnv = StreamTableEnvironment.create(env);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载 hive 模块</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;LOAD MODULE hive WITH (&#x27;hive-version&#x27; = &#x27;3.1.2&#x27;)&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW MODULES&quot;</span>).print();</span><br><span class="line"><span class="comment">// +-------------+</span></span><br><span class="line"><span class="comment">// | module name |</span></span><br><span class="line"><span class="comment">// +-------------+</span></span><br><span class="line"><span class="comment">// |        core |</span></span><br><span class="line"><span class="comment">// |        hive |</span></span><br><span class="line"><span class="comment">// +-------------+</span></span><br></pre></td></tr></table></figure>

<h4 id="sql-8"><a href="#sql-8" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">LOAD <span class="keyword">MODULE</span> hive <span class="keyword">WITH</span> (<span class="string">&#x27;hive-version&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;3.1.2&#x27;</span>);</span><br><span class="line">[INFO] Load <span class="keyword">module</span> succeeded<span class="operator">!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> MODULES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">module</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span>        core <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        hive <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br></pre></td></tr></table></figure>

<h3 id="LOAD-MODULE"><a href="#LOAD-MODULE" class="headerlink" title="LOAD MODULE"></a>LOAD MODULE</h3><p>以下语法概述了可用的语法规则:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LOAD <span class="keyword">MODULE</span> module_name [<span class="keyword">WITH</span> (<span class="string">&#x27;key1&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;val1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;val2&#x27;</span>, ...)]</span><br></pre></td></tr></table></figure>

<p>module_name 是一个简单的标识符.<br>它是区分大小写的,由于它被用于执行模块发现,因此也要与模块工厂(module factory)中定义的模块类型相同.<br>属性 (&#39;key1&#39; = &#39;val1&#39;, &#39;key2&#39; = &#39;val2&#39;, ...) 是一个 map 结构,它包含一组键值对(不包括 &#39;type&#39; 的键),这些属性会被传递给模块发现服务以实例化相应的模块.</p>
<h2 id="UNLOAD-语句"><a href="#UNLOAD-语句" class="headerlink" title="UNLOAD 语句"></a>UNLOAD 语句</h2><p>UNLOAD 语句用于卸载内置的或用户自定义的模块.</p>
<h3 id="执行-UNLOAD-语句"><a href="#执行-UNLOAD-语句" class="headerlink" title="执行 UNLOAD 语句"></a>执行 UNLOAD 语句</h3><h4 id="Java-9"><a href="#Java-9" class="headerlink" title="Java"></a>Java</h4><p>可以使用 TableEnvironment 的 executeSql() 方法执行 UNLOAD 语句.<br>如果 UNLOAD 操作执行成功,executeSql() 方法会返回 &#39;OK&#39;,否则会抛出异常.</p>
<p>以下示例展示了如何在 TableEnvironment 中执行一条 UNLOAD 语句.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">StreamTableEnvironment tEnv = StreamTableEnvironment.create(env);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卸载 core 模块</span></span><br><span class="line">tEnv.executeSql(<span class="string">&quot;UNLOAD MODULE core&quot;</span>);</span><br><span class="line">tEnv.executeSql(<span class="string">&quot;SHOW MODULES&quot;</span>).print();</span><br><span class="line"><span class="comment">// Empty set</span></span><br></pre></td></tr></table></figure>

<h4 id="sql-9"><a href="#sql-9" class="headerlink" title="sql"></a>sql</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UNLOAD <span class="keyword">MODULE</span> core;</span><br><span class="line">[INFO] Unload <span class="keyword">module</span> succeeded<span class="operator">!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> MODULES;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span></span><br></pre></td></tr></table></figure>

<h3 id="UNLOAD-MODULE"><a href="#UNLOAD-MODULE" class="headerlink" title="UNLOAD MODULE"></a>UNLOAD MODULE</h3><p>以下语法概述了可用的语法规则:<br>UNLOAD MODULE module_name</p>
<h2 id="SET-语句"><a href="#SET-语句" class="headerlink" title="SET 语句"></a>SET 语句</h2><p>SET 语句用于修改配置或展示配置.</p>
<h3 id="执行-SET-语句"><a href="#执行-SET-语句" class="headerlink" title="执行 SET 语句"></a>执行 SET 语句</h3><h4 id="sql-10"><a href="#sql-10" class="headerlink" title="sql"></a>sql</h4><p>SET 语句可以在 SQL CLI 中执行.</p>
<p>以下示例展示了如何在 SQL CLI 中执行一条 SET 语句.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="string">&#x27;table.local-time-zone&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;Europe/Berlin&#x27;</span>;</span><br><span class="line">[INFO] Session property has been set.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span>;</span><br><span class="line"><span class="string">&#x27;table.local-time-zone&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;Europe/Berlin&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><p>SET (&#39;key&#39; = &#39;value&#39;)?<br>如果没有指定 key 和 value,它仅仅打印所有属性.<br>否则,它会为 key 设置指定的 value 值.</p>
<h2 id="RESET-语句"><a href="#RESET-语句" class="headerlink" title="RESET 语句"></a>RESET 语句</h2><p>RESET 语句用于将配置重置为默认值.</p>
<h3 id="执行-RESET-语句"><a href="#执行-RESET-语句" class="headerlink" title="执行 RESET 语句"></a>执行 RESET 语句</h3><h4 id="sql-11"><a href="#sql-11" class="headerlink" title="sql"></a>sql</h4><p>RESET 语句可以在 SQL CLI 中执行.</p>
<p>以下示例展示了如何在 SQL CLI 中执行一条 RESET 语句.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RESET <span class="string">&#x27;table.planner&#x27;</span>;</span><br><span class="line">[INFO] Session property has been reset.</span><br><span class="line"></span><br><span class="line">RESET;</span><br><span class="line">[INFO] <span class="keyword">All</span> session properties have been <span class="keyword">set</span> <span class="keyword">to</span> their <span class="keyword">default</span> values.</span><br></pre></td></tr></table></figure>

<h3 id="Syntax-1"><a href="#Syntax-1" class="headerlink" title="Syntax"></a>Syntax</h3><p>RESET (&#39;key&#39;)?<br>如果未指定 key,则将所有属性重置为默认值.<br>否则,将指定的 key 重置为默认值.</p>
<h2 id="JAR-语句"><a href="#JAR-语句" class="headerlink" title="JAR 语句"></a>JAR 语句</h2><p>JAR 语句用于将用户 jar 添加到 classpath/或将用户 jar 从 classpath 中删除或展示运行时 classpath 中添加的 jar.</p>
<p>目前 Flink SQL 支持以下 JAR 语句:<br>ADD JAR<br>REMOVE JAR<br>SHOW JARS<br>注意 JAR 语句仅适用于 SQL CLI.</p>
<h3 id="执行-JAR-语句"><a href="#执行-JAR-语句" class="headerlink" title="执行 JAR 语句"></a>执行 JAR 语句</h3><h4 id="sql-12"><a href="#sql-12" class="headerlink" title="sql"></a>sql</h4><p>以下示例展示了如何在 SQL CLI 中运行 JAR 语句.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span> JAR <span class="string">&#x27;/path/hello.jar&#x27;</span>;</span><br><span class="line">[INFO] The specified jar <span class="keyword">is</span> added <span class="keyword">into</span> session classloader.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> JARS;</span><br><span class="line"><span class="operator">/</span>path<span class="operator">/</span>hello.jar</span><br><span class="line"></span><br><span class="line">REMOVE JAR <span class="string">&#x27;/path/hello.jar&#x27;</span>;</span><br><span class="line">[INFO] The specified jar <span class="keyword">is</span> removed <span class="keyword">from</span> session classloader.</span><br></pre></td></tr></table></figure>

<h3 id="ADD-JAR"><a href="#ADD-JAR" class="headerlink" title="ADD JAR"></a>ADD JAR</h3><p><code>ADD JAR &#39;&lt;path_to_filename&gt;.jar&#39;</code><br>目前只支持将本地 jar 添加到会话类类加载器(session classloader)中.</p>
<h3 id="REMOVE-JAR"><a href="#REMOVE-JAR" class="headerlink" title="REMOVE JAR"></a>REMOVE JAR</h3><p><code>REMOVE JAR &#39;&lt;path_to_filename&gt;.jar&#39;</code><br>目前只支持删除 ADD JAR 语句添加的 jar.</p>
<h3 id="SHOW-JARS-1"><a href="#SHOW-JARS-1" class="headerlink" title="SHOW JARS"></a>SHOW JARS</h3><p>SHOW JARS<br>展示会话类类加载器(session classloader)中所有基于 ADD JAR 语句添加的 jar.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/flink/" rel="tag"># flink</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/08/22/flink%20sql/" rel="prev" title="flink sql">
                  <i class="fa fa-chevron-left"></i> flink sql
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/08/22/flink%20sql-%E5%87%BD%E6%95%B0/" rel="next" title="flink sql-函数">
                  flink sql-函数 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">maoeryu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  





</body>
</html>
